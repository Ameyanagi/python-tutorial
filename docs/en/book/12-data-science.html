<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>data-science – Python Tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f26cc22a7ed9ce20feebf1a8f807cd9d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-bcc33e8b4b9e831ec76c3e80f6802942.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f26cc22a7ed9ce20feebf1a8f807cd9d.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-0b833b85a71a7e87b147d1e4308bdc3e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-412dd066460d3c467467393743c965a0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-0b833b85a71a7e87b147d1e4308bdc3e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../en/shared/python-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Python Tutorial</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">🏠 Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../en/book/index.html"> 
<span class="menu-text">📖 English Book</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ja/book/index.html"> 
<span class="menu-text">📖 日本語ブック</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../en/slides/index.html"> 
<span class="menu-text">🎯 English Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../ja/slides/index.html"> 
<span class="menu-text">🎯 日本語スライド</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ameyanagi/python-tutorial"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#core-data-science-libraries" id="toc-core-data-science-libraries" class="nav-link active" data-scroll-target="#core-data-science-libraries"><span class="header-section-number">1</span> Core Data Science Libraries</a>
  <ul class="collapse">
  <li><a href="#numpy---numerical-computing" id="toc-numpy---numerical-computing" class="nav-link" data-scroll-target="#numpy---numerical-computing"><span class="header-section-number">1.1</span> NumPy - Numerical Computing</a></li>
  <li><a href="#pandas---data-manipulation" id="toc-pandas---data-manipulation" class="nav-link" data-scroll-target="#pandas---data-manipulation"><span class="header-section-number">1.2</span> Pandas - Data Manipulation</a></li>
  <li><a href="#working-with-your-own-data-files" id="toc-working-with-your-own-data-files" class="nav-link" data-scroll-target="#working-with-your-own-data-files"><span class="header-section-number">1.3</span> Working with Your Own Data Files</a></li>
  <li><a href="#matplotlib---data-visualization" id="toc-matplotlib---data-visualization" class="nav-link" data-scroll-target="#matplotlib---data-visualization"><span class="header-section-number">1.4</span> Matplotlib - Data Visualization</a></li>
  </ul></li>
  <li><a href="#working-with-different-file-formats" id="toc-working-with-different-file-formats" class="nav-link" data-scroll-target="#working-with-different-file-formats"><span class="header-section-number">2</span> Working with Different File Formats</a></li>
  <li><a href="#real-world-data-science-project" id="toc-real-world-data-science-project" class="nav-link" data-scroll-target="#real-world-data-science-project"><span class="header-section-number">3</span> Real-World Data Science Project</a>
  <ul class="collapse">
  <li><a href="#project-sales-data-analysis" id="toc-project-sales-data-analysis" class="nav-link" data-scroll-target="#project-sales-data-analysis"><span class="header-section-number">3.1</span> Project: Sales Data Analysis</a></li>
  </ul></li>
  <li><a href="#machine-learning-basics" id="toc-machine-learning-basics" class="nav-link" data-scroll-target="#machine-learning-basics"><span class="header-section-number">4</span> Machine Learning Basics</a>
  <ul class="collapse">
  <li><a href="#scikit-learn-introduction" id="toc-scikit-learn-introduction" class="nav-link" data-scroll-target="#scikit-learn-introduction"><span class="header-section-number">4.1</span> Scikit-learn Introduction</a></li>
  </ul></li>
  <li><a href="#data-science-workflow" id="toc-data-science-workflow" class="nav-link" data-scroll-target="#data-science-workflow"><span class="header-section-number">5</span> Data Science Workflow</a>
  <ul class="collapse">
  <li><a href="#end-to-end-data-science-project" id="toc-end-to-end-data-science-project" class="nav-link" data-scroll-target="#end-to-end-data-science-project"><span class="header-section-number">5.1</span> End-to-End Data Science Project</a></li>
  </ul></li>
  <li><a href="#self-review-questions" id="toc-self-review-questions" class="nav-link" data-scroll-target="#self-review-questions"><span class="header-section-number">6</span> Self-Review Questions</a>
  <ul class="collapse">
  <li><a href="#knowledge-check" id="toc-knowledge-check" class="nav-link" data-scroll-target="#knowledge-check"><span class="header-section-number">6.1</span> Knowledge Check</a></li>
  <li><a href="#practical-exercises" id="toc-practical-exercises" class="nav-link" data-scroll-target="#practical-exercises"><span class="header-section-number">6.2</span> Practical Exercises</a></li>
  <li><a href="#answers" id="toc-answers" class="nav-link" data-scroll-target="#answers"><span class="header-section-number">6.3</span> Answers</a></li>
  </ul></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices"><span class="header-section-number">7</span> Best Practices</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">8</span> Next Steps</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">9</span> Resources</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="12-data-science.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Data Science with Python</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Python is the leading language for data science, offering powerful libraries for data manipulation, analysis, visualization, and machine learning.</p>
<section id="core-data-science-libraries" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="core-data-science-libraries"><span class="header-section-number">1</span> Core Data Science Libraries</h2>
<section id="numpy---numerical-computing" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="numpy---numerical-computing"><span class="header-section-number">1.1</span> NumPy - Numerical Computing</h3>
<div id="5976732e" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create arrays and basic operations</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== NumPy Basics ==="</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create arrays</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1D array: </span><span class="sc">{</span>arr1<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2D array:</span><span class="ch">\n</span><span class="sc">{</span>arr2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Array shape: </span><span class="sc">{</span>arr2<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Array data type: </span><span class="sc">{</span>arr2<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Array operations</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Array operations:"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation: </span><span class="sc">{</span>np<span class="sc">.</span>std(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Max value: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise operations</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>squared <span class="op">=</span> arr1 <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Squared: </span><span class="sc">{</span>squared<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Boolean indexing</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Values &gt; 3: </span><span class="sc">{</span>arr1[arr1 <span class="op">&gt;</span> <span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical operations on 2D array</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">2D array statistics:"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum of each column: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(arr2, axis<span class="op">=</span><span class="dv">0</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean of each row: </span><span class="sc">{</span>np<span class="sc">.</span>mean(arr2, axis<span class="op">=</span><span class="dv">1</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== NumPy Basics ===
1D array: [1 2 3 4 5]
2D array:
[[1 2 3]
 [4 5 6]
 [7 8 9]]
Array shape: (3, 3)
Array data type: int64

Array operations:
Sum: 15
Mean: 3.0
Standard deviation: 1.4142135623730951
Max value: 5
Squared: [ 1  4  9 16 25]
Values &gt; 3: [4 5]

2D array statistics:
Sum of each column: [12 15 18]
Mean of each row: [2. 5. 8.]</code></pre>
</div>
</div>
</section>
<section id="pandas---data-manipulation" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="pandas---data-manipulation"><span class="header-section-number">1.2</span> Pandas - Data Manipulation</h3>
<div id="88a191b4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Pandas Basics ==="</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'Diana'</span>, <span class="st">'Eve'</span>],</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">28</span>, <span class="dv">32</span>],</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'New York'</span>, <span class="st">'London'</span>, <span class="st">'Tokyo'</span>, <span class="st">'Paris'</span>, <span class="st">'Sydney'</span>],</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Salary'</span>: [<span class="dv">70000</span>, <span class="dv">80000</span>, <span class="dv">90000</span>, <span class="dv">65000</span>, <span class="dv">75000</span>],</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Department'</span>: [<span class="st">'Engineering'</span>, <span class="st">'Marketing'</span>, <span class="st">'Engineering'</span>, <span class="st">'HR'</span>, <span class="st">'Marketing'</span>]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample DataFrame:"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DataFrame info:"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Data types:</span><span class="ch">\n</span><span class="sc">{</span>df<span class="sc">.</span>dtypes<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic operations</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Basic statistics:"</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering data</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Engineering employees:"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>engineering <span class="op">=</span> df[df[<span class="st">'Department'</span>] <span class="op">==</span> <span class="st">'Engineering'</span>]</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(engineering)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping and aggregation</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Salary by department:"</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>dept_salary <span class="op">=</span> df.groupby(<span class="st">'Department'</span>)[<span class="st">'Salary'</span>].agg([<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>])</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dept_salary)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding new columns</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Salary_Rank'</span>] <span class="op">=</span> df[<span class="st">'Salary'</span>].rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Age_Group'</span>] <span class="op">=</span> pd.cut(df[<span class="st">'Age'</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">100</span>], labels<span class="op">=</span>[<span class="st">'Young'</span>, <span class="st">'Mid'</span>, <span class="st">'Senior'</span>])</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DataFrame with new columns:"</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[[<span class="st">'Name'</span>, <span class="st">'Age'</span>, <span class="st">'Age_Group'</span>, <span class="st">'Salary'</span>, <span class="st">'Salary_Rank'</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Pandas Basics ===
Sample DataFrame:
      Name  Age      City  Salary   Department
0    Alice   25  New York   70000  Engineering
1      Bob   30    London   80000    Marketing
2  Charlie   35     Tokyo   90000  Engineering
3    Diana   28     Paris   65000           HR
4      Eve   32    Sydney   75000    Marketing

DataFrame info:
Shape: (5, 5)
Columns: ['Name', 'Age', 'City', 'Salary', 'Department']
Data types:
Name          object
Age            int64
City          object
Salary         int64
Department    object
dtype: object

Basic statistics:
             Age        Salary
count   5.000000      5.000000
mean   30.000000  76000.000000
std     3.807887   9617.692031
min    25.000000  65000.000000
25%    28.000000  70000.000000
50%    30.000000  75000.000000
75%    32.000000  80000.000000
max    35.000000  90000.000000

Engineering employees:
      Name  Age      City  Salary   Department
0    Alice   25  New York   70000  Engineering
2  Charlie   35     Tokyo   90000  Engineering

Salary by department:
                mean    min    max
Department                        
Engineering  80000.0  70000  90000
HR           65000.0  65000  65000
Marketing    77500.0  75000  80000

DataFrame with new columns:
      Name  Age Age_Group  Salary  Salary_Rank
0    Alice   25     Young   70000          4.0
1      Bob   30     Young   80000          2.0
2  Charlie   35       Mid   90000          1.0
3    Diana   28     Young   65000          5.0
4      Eve   32       Mid   75000          3.0</code></pre>
</div>
</div>
</section>
<section id="working-with-your-own-data-files" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="working-with-your-own-data-files"><span class="header-section-number">1.3</span> Working with Your Own Data Files</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
📁 Upload Your Own CSV Files
</div>
</div>
<div class="callout-body-container callout-body">
<p>With <strong>Quarto Drop</strong>, you can drag and drop your own CSV files directly into the browser! Try uploading a CSV file in the area below and analyze it with Pandas.</p>
</div>
</div>
<div id="file-upload" class="cell" data-drop="true" data-execution_count="3">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>data.csv</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drag and drop your CSV file here to upload it</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This will work when you drop a CSV file</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the uploaded file</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    df_uploaded <span class="op">=</span> pd.read_csv(<span class="st">'data.csv'</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"=== Your Uploaded Data ==="</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span>df_uploaded<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Columns: </span><span class="sc">{</span><span class="bu">list</span>(df_uploaded.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First 5 rows:"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_uploaded.head())</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Basic statistics:"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_uploaded.describe())</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show data types</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Data types:"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_uploaded.dtypes)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"📁 No file uploaded yet. Drag and drop a CSV file above to analyze it!"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"You can create a simple CSV file with columns like: Name,Age,City,Salary"</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error reading file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Make sure your file is a valid CSV format."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>📁 No file uploaded yet. Drag and drop a CSV file above to analyze it!
You can create a simple CSV file with columns like: Name,Age,City,Salary</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🎯 Try This
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Create a simple CSV file on your computer with data like:</p>
<pre><code>Name,Age,Department,Salary
John,25,Engineering,70000
Jane,30,Marketing,65000</code></pre></li>
<li><p>Drag and drop it into the code area above</p></li>
<li><p>The code will automatically analyze your data!</p></li>
</ol>
</div>
</div>
</section>
<section id="matplotlib---data-visualization" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="matplotlib---data-visualization"><span class="header-section-number">1.4</span> Matplotlib - Data Visualization</h3>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
📊 Interactive Plotting
</div>
</div>
<div class="callout-body-container callout-body">
<p>With <strong>Quarto Live</strong>, you can modify the plotting code below and see the results instantly! Try changing colors, plot types, or data values to experiment with different visualizations.</p>
</div>
</div>
<div id="f2ae9ad7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure matplotlib for Quarto</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Interactive Data Visualization ==="</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive example: Create your own data</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(x) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">50</span>)  <span class="co"># Try changing the multiplier!</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'bo-'</span>, markersize<span class="op">=</span><span class="dv">4</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)  <span class="co"># Try different colors!</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Interactive Plot - Modify and Run!'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X values'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y values'</span>) </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Try modifying the plot above - change colors, markers, or the mathematical function!"</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.date_range(<span class="st">'2023-01-01'</span>, periods<span class="op">=</span><span class="dv">100</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.cumsum(np.random.randn(<span class="dv">100</span>)) <span class="op">+</span> <span class="dv">100</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>sales_data <span class="op">=</span> pd.DataFrame({<span class="st">'Date'</span>: dates, <span class="st">'Sales'</span>: values})</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Line plot</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>plt.plot(sales_data[<span class="st">'Date'</span>], sales_data[<span class="st">'Sales'</span>], linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sales Over Time'</span>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Sales ($)'</span>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>plt.hist(sales_data[<span class="st">'Sales'</span>], bins<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'green'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sales Distribution'</span>)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Sales ($)'</span>)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with categories</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>]</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.randn(<span class="dv">150</span>)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.randn(<span class="dv">150</span>)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> np.random.choice(categories, <span class="dv">150</span>)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category <span class="kw">in</span> categories:</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> colors <span class="op">==</span> category</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    plt.scatter(x[mask], y[mask], label<span class="op">=</span><span class="ss">f'Category </span><span class="sc">{</span>category<span class="sc">}</span><span class="ss">'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot by Category'</span>)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X Value'</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y Value'</span>)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>departments <span class="op">=</span> [<span class="st">'Engineering'</span>, <span class="st">'Marketing'</span>, <span class="st">'HR'</span>, <span class="st">'Sales'</span>]</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>avg_salaries <span class="op">=</span> [<span class="dv">85000</span>, <span class="dv">72000</span>, <span class="dv">65000</span>, <span class="dv">78000</span>]</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> plt.bar(departments, avg_salaries, color<span class="op">=</span>[<span class="st">'skyblue'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightcoral'</span>, <span class="st">'gold'</span>])</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Salary by Department'</span>)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Department'</span>)</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Salary ($)'</span>)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Add value labels on bars</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, salary <span class="kw">in</span> <span class="bu">zip</span>(bars, avg_salaries):</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>    plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="dv">2</span>, bar.get_height() <span class="op">+</span> <span class="dv">1000</span>,</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>             <span class="ss">f'$</span><span class="sc">{</span>salary<span class="sc">:,}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Visualization plots created successfully!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Interactive Data Visualization ===</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_132962/2707780485.py:16: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "bo-" (-&gt; color='b'). The keyword argument will take precedence.
  plt.plot(x, y, 'bo-', markersize=4, linewidth=2, color='blue')  # Try different colors!</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="12-data-science_files/figure-html/cell-5-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Try modifying the plot above - change colors, markers, or the mathematical function!</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="12-data-science_files/figure-html/cell-5-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Visualization plots created successfully!</code></pre>
</div>
</div>
</section>
</section>
<section id="working-with-different-file-formats" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="working-with-different-file-formats"><span class="header-section-number">2</span> Working with Different File Formats</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
📊 Upload Excel and Other Data Files
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beyond CSV files, you can also upload Excel files (.xlsx), JSON files, and other formats for analysis. Try dropping different file types below!</p>
</div>
</div>
<div id="multi-file-upload" class="cell" data-drop="true" data-execution_count="5">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>datafile</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drag and drop Excel, JSON, or other data files here</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_uploaded_file(filename):</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Analyze different types of uploaded files"""</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        file_ext <span class="op">=</span> os.path.splitext(filename)[<span class="dv">1</span>].lower()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> file_ext <span class="op">==</span> <span class="st">'.csv'</span>:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.read_csv(filename)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"📊 CSV file loaded: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> file_ext <span class="kw">in</span> [<span class="st">'.xlsx'</span>, <span class="st">'.xls'</span>]:</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.read_excel(filename)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"📈 Excel file loaded: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> file_ext <span class="op">==</span> <span class="st">'.json'</span>:</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.json_normalize(data)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"🔗 JSON file loaded: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"❌ Unsupported file type: </span><span class="sc">{</span>file_ext<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Supported formats: CSV (.csv), Excel (.xlsx, .xls), JSON (.json)"</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Analyze the loaded data</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== File Analysis ==="</span>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Columns: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Memory usage: </span><span class="sc">{</span>df<span class="sc">.</span>memory_usage(deep<span class="op">=</span><span class="va">True</span>)<span class="sc">.</span><span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1024</span><span class="sc">:.1f}</span><span class="ss"> KB"</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== First 3 rows ==="</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(df.head(<span class="dv">3</span>))</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Data types ==="</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(df.dtypes)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check for missing values</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        missing_values <span class="op">=</span> df.isnull().<span class="bu">sum</span>()</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> missing_values.<span class="bu">any</span>():</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Missing values ==="</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(missing_values[missing_values <span class="op">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✅ No missing values found!"</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Quick statistics for numeric columns</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>        numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(numeric_cols) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Statistics for numeric columns ==="</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(df[numeric_cols].describe())</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"❌ Error processing file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Please ensure your file is in a valid format."</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a file was uploaded</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    uploaded_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(<span class="st">'.'</span>) <span class="cf">if</span> f <span class="op">!=</span> <span class="st">'datafile'</span>]</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> uploaded_files:</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> uploaded_files:</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">file</span>.startswith(<span class="st">'.'</span>):  <span class="co"># Skip hidden files</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>                df_analysis <span class="op">=</span> analyze_uploaded_file(<span class="bu">file</span>)</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"📁 No file uploaded yet."</span>)</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Supported formats:"</span>)</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"• CSV files (.csv)"</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"• Excel files (.xlsx, .xls)"</span>)  </span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"• JSON files (.json)"</span>)</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Drag and drop a file above to analyze it!"</span>)</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"📁 Drag and drop a data file above to get started!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>❌ Unsupported file type: .qmd
Supported formats: CSV (.csv), Excel (.xlsx, .xls), JSON (.json)</code></pre>
</div>
</div>
</section>
<section id="real-world-data-science-project" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="real-world-data-science-project"><span class="header-section-number">3</span> Real-World Data Science Project</h2>
<section id="project-sales-data-analysis" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="project-sales-data-analysis"><span class="header-section-number">3.1</span> Project: Sales Data Analysis</h3>
<div id="f0b26a88" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalesAnalyzer:</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Comprehensive sales data analyzer."""</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.summary_stats <span class="op">=</span> {}</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_sample_data(<span class="va">self</span>, num_records: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1000</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate realistic sales data for analysis."""</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        np.random.seed(<span class="dv">42</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Date range</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        start_date <span class="op">=</span> datetime(<span class="dv">2023</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        end_date <span class="op">=</span> datetime(<span class="dv">2023</span>, <span class="dv">12</span>, <span class="dv">31</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        dates <span class="op">=</span> pd.date_range(start_date, end_date, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate data</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> []</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        products <span class="op">=</span> [<span class="st">'Laptop'</span>, <span class="st">'Desktop'</span>, <span class="st">'Tablet'</span>, <span class="st">'Phone'</span>, <span class="st">'Monitor'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Mouse'</span>]</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        regions <span class="op">=</span> [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'West'</span>, <span class="st">'Central'</span>]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        sales_reps <span class="op">=</span> [<span class="ss">f'Rep_</span><span class="sc">{</span>i<span class="sc">:02d}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">21</span>)]</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_records):</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>            date <span class="op">=</span> np.random.choice(dates)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>            product <span class="op">=</span> np.random.choice(products)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>            region <span class="op">=</span> np.random.choice(regions)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>            sales_rep <span class="op">=</span> np.random.choice(sales_reps)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Product-specific pricing</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>            base_prices <span class="op">=</span> {</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Laptop'</span>: <span class="dv">1200</span>, <span class="st">'Desktop'</span>: <span class="dv">800</span>, <span class="st">'Tablet'</span>: <span class="dv">400</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Phone'</span>: <span class="dv">600</span>, <span class="st">'Monitor'</span>: <span class="dv">300</span>, <span class="st">'Keyboard'</span>: <span class="dv">80</span>, <span class="st">'Mouse'</span>: <span class="dv">40</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>            base_price <span class="op">=</span> base_prices[product]</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>            quantity <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add some seasonality and randomness</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>            month_factor <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> pd.Timestamp(date).month <span class="op">/</span> <span class="dv">12</span>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>            price <span class="op">=</span> base_price <span class="op">*</span> month_factor <span class="op">*</span> np.random.uniform(<span class="fl">0.8</span>, <span class="fl">1.2</span>)</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>            revenue <span class="op">=</span> price <span class="op">*</span> quantity</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Simulate costs (60-80% of revenue)</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>            cost_ratio <span class="op">=</span> np.random.uniform(<span class="fl">0.6</span>, <span class="fl">0.8</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>            cost <span class="op">=</span> revenue <span class="op">*</span> cost_ratio</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>            profit <span class="op">=</span> revenue <span class="op">-</span> cost</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>            data.append({</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Date'</span>: date,</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Product'</span>: product,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Region'</span>: region,</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Sales_Rep'</span>: sales_rep,</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Quantity'</span>: quantity,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Unit_Price'</span>: price,</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Revenue'</span>: revenue,</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Cost'</span>: cost,</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Profit'</span>: profit</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Date'</span>])</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Month'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.month</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Quarter'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.quarter</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Day_of_Week'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.day_name()</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> df</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Generated </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss"> sales records"</span>)</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> basic_analysis(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Perform basic statistical analysis."""</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No data available. Generate data first."</span>)</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>        analysis <span class="op">=</span> {</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_records'</span>: <span class="bu">len</span>(df),</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>            <span class="st">'date_range'</span>: (df[<span class="st">'Date'</span>].<span class="bu">min</span>(), df[<span class="st">'Date'</span>].<span class="bu">max</span>()),</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_revenue'</span>: df[<span class="st">'Revenue'</span>].<span class="bu">sum</span>(),</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_profit'</span>: df[<span class="st">'Profit'</span>].<span class="bu">sum</span>(),</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>            <span class="st">'avg_order_value'</span>: df[<span class="st">'Revenue'</span>].mean(),</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">'profit_margin'</span>: (df[<span class="st">'Profit'</span>].<span class="bu">sum</span>() <span class="op">/</span> df[<span class="st">'Revenue'</span>].<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_product'</span>: df.groupby(<span class="st">'Product'</span>)[<span class="st">'Revenue'</span>].<span class="bu">sum</span>().idxmax(),</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_region'</span>: df.groupby(<span class="st">'Region'</span>)[<span class="st">'Revenue'</span>].<span class="bu">sum</span>().idxmax(),</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_sales_rep'</span>: df.groupby(<span class="st">'Sales_Rep'</span>)[<span class="st">'Revenue'</span>].<span class="bu">sum</span>().idxmax()</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.summary_stats <span class="op">=</span> analysis</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> analysis</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> time_series_analysis(<span class="va">self</span>):</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze sales trends over time."""</span></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Monthly analysis</span></span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>        monthly_sales <span class="op">=</span> df.groupby(df[<span class="st">'Date'</span>].dt.to_period(<span class="st">'M'</span>)).agg({</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: <span class="st">'sum'</span>,</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: <span class="st">'sum'</span>,</span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>        }).reset_index()</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>        monthly_sales[<span class="st">'Date'</span>] <span class="op">=</span> monthly_sales[<span class="st">'Date'</span>].dt.to_timestamp()</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Quarterly analysis</span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>        quarterly_sales <span class="op">=</span> df.groupby(<span class="st">'Quarter'</span>).agg({</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: <span class="st">'sum'</span>,</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: <span class="st">'sum'</span>,</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Day of week analysis</span></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>        dow_sales <span class="op">=</span> df.groupby(<span class="st">'Day_of_Week'</span>).agg({</span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: <span class="st">'mean'</span>,</span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'mean'</span></span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>        }).reindex([<span class="st">'Monday'</span>, <span class="st">'Tuesday'</span>, <span class="st">'Wednesday'</span>, <span class="st">'Thursday'</span>, <span class="st">'Friday'</span>, <span class="st">'Saturday'</span>, <span class="st">'Sunday'</span>])</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">'monthly'</span>: monthly_sales,</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">'quarterly'</span>: quarterly_sales,</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">'day_of_week'</span>: dow_sales</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> product_analysis(<span class="va">self</span>):</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze product performance."""</span></span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>        product_stats <span class="op">=</span> df.groupby(<span class="st">'Product'</span>).agg({</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'count'</span>],</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span>,</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Unit_Price'</span>: <span class="st">'mean'</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Flatten column names</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>        product_stats.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> product_stats.columns]</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate profit margin by product</span></span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>        product_stats[<span class="st">'Profit_Margin'</span>] <span class="op">=</span> (</span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>            product_stats[<span class="st">'Profit_sum'</span>] <span class="op">/</span> product_stats[<span class="st">'Revenue_sum'</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>        ).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> product_stats</span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> regional_analysis(<span class="va">self</span>):</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze regional performance."""</span></span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>        regional_stats <span class="op">=</span> df.groupby(<span class="st">'Region'</span>).agg({</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span></span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>        regional_stats.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> regional_stats.columns]</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Market share by region</span></span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>        total_revenue <span class="op">=</span> df[<span class="st">'Revenue'</span>].<span class="bu">sum</span>()</span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>        regional_stats[<span class="st">'Market_Share'</span>] <span class="op">=</span> (</span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>            regional_stats[<span class="st">'Revenue_sum'</span>] <span class="op">/</span> total_revenue <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>        ).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> regional_stats</span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sales_rep_analysis(<span class="va">self</span>):</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze sales representative performance."""</span></span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>        rep_stats <span class="op">=</span> df.groupby(<span class="st">'Sales_Rep'</span>).agg({</span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'count'</span>],</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: <span class="st">'sum'</span></span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>        rep_stats.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> rep_stats.columns]</span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rank representatives</span></span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a>        rep_stats[<span class="st">'Revenue_Rank'</span>] <span class="op">=</span> rep_stats[<span class="st">'Revenue_sum'</span>].rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a>        rep_stats[<span class="st">'Avg_Deal_Size'</span>] <span class="op">=</span> rep_stats[<span class="st">'Revenue_mean'</span>]</span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rep_stats.sort_values(<span class="st">'Revenue_sum'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_visualizations(<span class="va">self</span>):</span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Create comprehensive visualizations."""</span></span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(<span class="st">'Sales Data Analysis Dashboard'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Monthly Revenue Trend</span></span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a>        time_data <span class="op">=</span> <span class="va">self</span>.time_series_analysis()</span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a>        monthly_data <span class="op">=</span> time_data[<span class="st">'monthly'</span>]</span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(monthly_data[<span class="st">'Date'</span>], monthly_data[<span class="st">'Revenue'</span>], </span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a>                       marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Monthly Revenue Trend'</span>)</span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Month'</span>)</span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Revenue ($)'</span>)</span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Product Performance</span></span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>        product_data <span class="op">=</span> <span class="va">self</span>.product_analysis()</span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].bar(product_data.index, product_data[<span class="st">'Revenue_sum'</span>], </span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'lightgreen'</span>, edgecolor<span class="op">=</span><span class="st">'darkgreen'</span>)</span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Revenue by Product'</span>)</span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Product'</span>)</span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Total Revenue ($)'</span>)</span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Regional Market Share</span></span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a>        regional_data <span class="op">=</span> <span class="va">self</span>.regional_analysis()</span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].pie(regional_data[<span class="st">'Revenue_sum'</span>], labels<span class="op">=</span>regional_data.index, </span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>                      autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Market Share by Region'</span>)</span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Quarterly Profit Trend</span></span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a>        quarterly_data <span class="op">=</span> time_data[<span class="st">'quarterly'</span>]</span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].bar(quarterly_data.index, quarterly_data[<span class="st">'Profit'</span>], </span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'orange'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Quarterly Profit'</span>)</span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Quarter'</span>)</span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Profit ($)'</span>)</span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5. Day of Week Analysis</span></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a>        dow_data <span class="op">=</span> time_data[<span class="st">'day_of_week'</span>]</span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(<span class="bu">range</span>(<span class="bu">len</span>(dow_data)), dow_data[<span class="st">'Revenue'</span>], </span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a>                       marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Average Daily Revenue by Day of Week'</span>)</span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Day of Week'</span>)</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Average Revenue ($)'</span>)</span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(dow_data)))</span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticklabels(dow_data.index, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 6. Revenue vs Profit Scatter</span></span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].scatter(<span class="va">self</span>.data[<span class="st">'Revenue'</span>], <span class="va">self</span>.data[<span class="st">'Profit'</span>], </span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a>                          alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_title(<span class="st">'Revenue vs Profit Correlation'</span>)</span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_xlabel(<span class="st">'Revenue ($)'</span>)</span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_ylabel(<span class="st">'Profit ($)'</span>)</span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add trend line</span></span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> np.polyfit(<span class="va">self</span>.data[<span class="st">'Revenue'</span>], <span class="va">self</span>.data[<span class="st">'Profit'</span>], <span class="dv">1</span>)</span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].plot(<span class="va">self</span>.data[<span class="st">'Revenue'</span>], p(<span class="va">self</span>.data[<span class="st">'Revenue'</span>]), <span class="st">"r--"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_report(<span class="va">self</span>):</span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate comprehensive analysis report."""</span></span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"No data available. Generate data first."</span>)</span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>        basic_stats <span class="op">=</span> <span class="va">self</span>.basic_analysis()</span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"SALES DATA ANALYSIS REPORT"</span>)</span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">📊 OVERVIEW"</span>)</span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Total Records: </span><span class="sc">{</span>basic_stats[<span class="st">'total_records'</span>]<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Date Range: </span><span class="sc">{</span>basic_stats[<span class="st">'date_range'</span>][<span class="dv">0</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>basic_stats[<span class="st">'date_range'</span>][<span class="dv">1</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Total Revenue: $</span><span class="sc">{</span>basic_stats[<span class="st">'total_revenue'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Total Profit: $</span><span class="sc">{</span>basic_stats[<span class="st">'total_profit'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Profit Margin: </span><span class="sc">{</span>basic_stats[<span class="st">'profit_margin'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Average Order Value: $</span><span class="sc">{</span>basic_stats[<span class="st">'avg_order_value'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">🏆 TOP PERFORMERS"</span>)</span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Best Product: </span><span class="sc">{</span>basic_stats[<span class="st">'top_product'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Best Region: </span><span class="sc">{</span>basic_stats[<span class="st">'top_region'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Best Sales Rep: </span><span class="sc">{</span>basic_stats[<span class="st">'top_sales_rep'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Product analysis</span></span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">📦 PRODUCT ANALYSIS"</span>)</span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>        product_stats <span class="op">=</span> <span class="va">self</span>.product_analysis()</span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(product_stats.sort_values(<span class="st">'Revenue_sum'</span>, ascending<span class="op">=</span><span class="va">False</span>).head())</span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Regional analysis</span></span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">🌍 REGIONAL ANALYSIS"</span>)</span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>        regional_stats <span class="op">=</span> <span class="va">self</span>.regional_analysis()</span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(regional_stats.sort_values(<span class="st">'Revenue_sum'</span>, ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sales rep performance</span></span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">👥 TOP SALES REPRESENTATIVES"</span>)</span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a>        rep_stats <span class="op">=</span> <span class="va">self</span>.sales_rep_analysis()</span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(rep_stats.head(<span class="dv">10</span>))</span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate the sales analyzer</span></span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>analyzer <span class="op">=</span> SalesAnalyzer()</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>analyzer.generate_sample_data(<span class="dv">1500</span>)</span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>analyzer.generate_report()</span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>analyzer.create_visualizations()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generated 1500 sales records
============================================================
SALES DATA ANALYSIS REPORT
============================================================

📊 OVERVIEW
   Total Records: 1,500
   Date Range: 2023-01-01 to 2023-12-31
   Total Revenue: $3,744,106.54
   Total Profit: $1,132,747.36
   Profit Margin: 30.3%
   Average Order Value: $2,496.07

🏆 TOP PERFORMERS
   Best Product: Laptop
   Best Region: North
   Best Sales Rep: Rep_10

📦 PRODUCT ANALYSIS
         Revenue_sum  Revenue_mean  Revenue_count  Profit_sum  Profit_mean  \
Product                                                                      
Laptop    1457821.72       6256.75            233   438606.31      1882.43   
Desktop    850191.63       3882.15            219   265613.37      1212.85   
Phone      565223.62       2943.87            192   170610.69       888.60   
Tablet     426859.86       1994.67            214   124763.71       583.01   
Monitor    318659.91       1517.43            210    95756.25       455.98   

         Quantity_sum  Unit_Price_mean  Profit_Margin  
Product                                                
Laptop           1233          1177.84          30.09  
Desktop          1084           793.92          31.24  
Phone             943           605.55          30.18  
Tablet           1058           401.77          29.23  
Monitor          1070           299.48          30.05  

🌍 REGIONAL ANALYSIS
         Revenue_sum  Revenue_mean  Profit_sum  Profit_mean  Quantity_sum  \
Region                                                                      
North      800986.13       2661.08   246662.85       819.48          1556   
Central    761361.35       2589.66   234742.99       798.45          1481   
East       756481.48       2271.72   229612.70       689.53          1640   
South      754923.43       2621.26   227312.49       789.28          1411   
West       670354.15       2360.40   194416.33       684.56          1462   

         Market_Share  
Region                 
North           21.39  
Central         20.33  
East            20.20  
South           20.16  
West            17.90  

👥 TOP SALES REPRESENTATIVES
           Revenue_sum  Revenue_mean  Revenue_count  Profit_sum  Revenue_Rank  \
Sales_Rep                                                                       
Rep_10       243717.54       2833.92             86    73055.56           1.0   
Rep_13       225859.36       2377.47             95    70286.25           2.0   
Rep_17       218418.71       2454.14             89    63557.69           3.0   
Rep_11       214187.04       2745.99             78    65746.85           4.0   
Rep_02       206736.55       2911.78             71    64414.03           5.0   
Rep_16       204981.50       2662.10             77    62956.06           6.0   
Rep_15       200853.92       2391.12             84    60391.97           7.0   
Rep_07       197607.60       2744.55             72    60711.78           8.0   
Rep_06       190105.13       2677.54             71    57937.40           9.0   
Rep_05       189931.81       2601.81             73    57419.80          10.0   

           Avg_Deal_Size  
Sales_Rep                 
Rep_10           2833.92  
Rep_13           2377.47  
Rep_17           2454.14  
Rep_11           2745.99  
Rep_02           2911.78  
Rep_16           2662.10  
Rep_15           2391.12  
Rep_07           2744.55  
Rep_06           2677.54  
Rep_05           2601.81  </code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="12-data-science_files/figure-html/cell-7-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="machine-learning-basics" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="machine-learning-basics"><span class="header-section-number">4</span> Machine Learning Basics</h2>
<section id="scikit-learn-introduction" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="scikit-learn-introduction"><span class="header-section-number">4.1</span> Scikit-learn Introduction</h3>
<div id="5da02cb6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, LogisticRegression</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, accuracy_score, classification_report</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Machine Learning with Scikit-learn ==="</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression_example():</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Demonstrate linear regression."""</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. Linear Regression Example"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate sample data</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.random.randn(n_samples, <span class="dv">3</span>)  <span class="co"># 3 features</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    true_coefficients <span class="op">=</span> [<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="fl">0.5</span>]</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> X.dot(true_coefficients) <span class="op">+</span> np.random.randn(n_samples) <span class="op">*</span> <span class="fl">0.1</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create feature names</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [<span class="st">'Feature_1'</span>, <span class="st">'Feature_2'</span>, <span class="st">'Feature_3'</span>]</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    X_df <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>feature_names)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split data</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>        X_df, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train model</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> LinearRegression()</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    r2_score <span class="op">=</span> model.score(X_test, y_test)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Model Coefficients: </span><span class="sc">{</span>model<span class="sc">.</span>coef_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   True Coefficients: </span><span class="sc">{</span>true_coefficients<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Mean Squared Error: </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   R² Score: </span><span class="sc">{</span>r2_score<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model, X_test, y_test, y_pred</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classification_example():</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Demonstrate classification."""</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Classification Example"</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate sample data</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>        n_samples<span class="op">=</span><span class="dv">1000</span>, n_features<span class="op">=</span><span class="dv">10</span>, n_informative<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>        n_redundant<span class="op">=</span><span class="dv">2</span>, n_classes<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [<span class="ss">f'Feature_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>])]</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    X_df <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>feature_names)</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split data</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>        X_df, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scale features</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train models</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> {</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Logistic Regression'</span>: LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Random Forest'</span>: RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train_scaled, y_train)</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> model.predict(X_test_scaled)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluate</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>        results[name] <span class="op">=</span> {</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: model,</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">'accuracy'</span>: accuracy,</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">'predictions'</span>: y_pred</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results, X_test_scaled, y_test</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Run examples</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>regression_model, X_reg_test, y_reg_test, y_reg_pred <span class="op">=</span> regression_example()</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>classification_results, X_clf_test, y_clf_test <span class="op">=</span> classification_example()</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance for Random Forest</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> classification_results[<span class="st">'Random Forest'</span>][<span class="st">'model'</span>]</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: [<span class="ss">f'Feature_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(rf_model.feature_importances_))],</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Importance'</span>: rf_model.feature_importances_</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Random Forest Feature Importance:"</span>)</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Machine Learning with Scikit-learn ===

1. Linear Regression Example
   Model Coefficients: [ 1.99620723 -0.98120071  0.51306256]
   True Coefficients: [2, -1, 0.5]
   Mean Squared Error: 0.0097
   R² Score: 0.9978

2. Classification Example

   Logistic Regression:
     Accuracy: 0.670

   Random Forest:
     Accuracy: 0.857

   Random Forest Feature Importance:
     Feature  Importance
8  Feature_9    0.213688
4  Feature_5    0.131887
3  Feature_4    0.121518
0  Feature_1    0.116163
6  Feature_7    0.115422</code></pre>
</div>
</div>
</section>
</section>
<section id="data-science-workflow" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="data-science-workflow"><span class="header-section-number">5</span> Data Science Workflow</h2>
<section id="end-to-end-data-science-project" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="end-to-end-data-science-project"><span class="header-section-number">5.1</span> End-to-End Data Science Project</h3>
<div id="2fd8c559" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, cross_val_score</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelEncoder</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataScienceProject:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""End-to-end data science project workflow."""</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, project_name: <span class="bu">str</span>):</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.project_name <span class="op">=</span> project_name</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processed_data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.scaler <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label_encoder <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_and_explore_data(<span class="va">self</span>):</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 1: Load and explore the dataset."""</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"=== </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss">: Data Exploration ==="</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate a realistic customer dataset</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        np.random.seed(<span class="dv">42</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        n_customers <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Customer demographics</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        ages <span class="op">=</span> np.random.normal(<span class="dv">40</span>, <span class="dv">12</span>, n_customers).astype(<span class="bu">int</span>)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        ages <span class="op">=</span> np.clip(ages, <span class="dv">18</span>, <span class="dv">80</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        incomes <span class="op">=</span> np.random.lognormal(<span class="fl">10.5</span>, <span class="fl">0.5</span>, n_customers)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Education levels</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        education_levels <span class="op">=</span> np.random.choice(</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>            [<span class="st">'High School'</span>, <span class="st">'Bachelor'</span>, <span class="st">'Master'</span>, <span class="st">'PhD'</span>],</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>            n_customers, p<span class="op">=</span>[<span class="fl">0.4</span>, <span class="fl">0.35</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>]</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Spending behavior (influenced by income and age)</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        base_spending <span class="op">=</span> incomes <span class="op">*</span> <span class="fl">0.1</span> <span class="op">+</span> ages <span class="op">*</span> <span class="dv">50</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>        spending <span class="op">=</span> base_spending <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">500</span>, n_customers)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>        spending <span class="op">=</span> np.clip(spending, <span class="dv">0</span>, <span class="va">None</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Customer segment (target variable)</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>        segments <span class="op">=</span> []</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_customers):</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spending[i] <span class="op">&gt;</span> <span class="dv">8000</span>:</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>                segment <span class="op">=</span> <span class="st">'Premium'</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> spending[i] <span class="op">&gt;</span> <span class="dv">4000</span>:</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>                segment <span class="op">=</span> <span class="st">'Standard'</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                segment <span class="op">=</span> <span class="st">'Basic'</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>            segments.append(segment)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create DataFrame</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Age'</span>: ages,</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Income'</span>: incomes,</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Education'</span>: education_levels,</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Annual_Spending'</span>: spending,</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Segment'</span>: segments</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">First 5 rows:"</span>)</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.head())</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Dataset info:"</span>)</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.info())</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Basic statistics:"</span>)</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.describe())</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Segment distribution:"</span>)</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data[<span class="st">'Segment'</span>].value_counts())</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.data</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> data_preprocessing(<span class="va">self</span>):</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 2: Clean and preprocess the data."""</span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Data Preprocessing ==="</span>)</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Load data first"</span>)</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check for missing values</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Missing values:"</span>)</span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.isnull().<span class="bu">sum</span>())</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Encode categorical variables</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label_encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>        processed_data <span class="op">=</span> <span class="va">self</span>.data.copy()</span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>        processed_data[<span class="st">'Education_Encoded'</span>] <span class="op">=</span> <span class="va">self</span>.label_encoder.fit_transform(</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>            processed_data[<span class="st">'Education'</span>]</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create additional features</span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>        processed_data[<span class="st">'Income_to_Age_Ratio'</span>] <span class="op">=</span> processed_data[<span class="st">'Income'</span>] <span class="op">/</span> processed_data[<span class="st">'Age'</span>]</span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>        processed_data[<span class="st">'Spending_to_Income_Ratio'</span>] <span class="op">=</span> processed_data[<span class="st">'Annual_Spending'</span>] <span class="op">/</span> processed_data[<span class="st">'Income'</span>]</span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Feature selection for modeling</span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>        feature_columns <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'Income'</span>, <span class="st">'Education_Encoded'</span>, <span class="st">'Annual_Spending'</span>, </span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'Income_to_Age_Ratio'</span>, <span class="st">'Spending_to_Income_Ratio'</span>]</span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processed_data <span class="op">=</span> {</span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>            <span class="st">'features'</span>: processed_data[feature_columns],</span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>            <span class="st">'target'</span>: processed_data[<span class="st">'Segment'</span>],</span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">'full_data'</span>: processed_data</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Features selected: </span><span class="sc">{</span>feature_columns<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Target variable: Segment"</span>)</span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Processed data shape: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>processed_data[<span class="st">'features'</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.processed_data</span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> exploratory_data_analysis(<span class="va">self</span>):</span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 3: Perform exploratory data analysis."""</span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Exploratory Data Analysis ==="</span>)</span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.processed_data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.data_preprocessing()</span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(<span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss">: Exploratory Data Analysis'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a>        full_data <span class="op">=</span> <span class="va">self</span>.processed_data[<span class="st">'full_data'</span>]</span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Age distribution by segment</span></span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> segment <span class="kw">in</span> full_data[<span class="st">'Segment'</span>].unique():</span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a>            segment_data <span class="op">=</span> full_data[full_data[<span class="st">'Segment'</span>] <span class="op">==</span> segment]</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a>            axes[<span class="dv">0</span>, <span class="dv">0</span>].hist(segment_data[<span class="st">'Age'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span>segment, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Age Distribution by Segment'</span>)</span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Age'</span>)</span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].legend()</span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Income vs Spending</span></span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>        segments <span class="op">=</span> full_data[<span class="st">'Segment'</span>].unique()</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a>        colors <span class="op">=</span> [<span class="st">'red'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>]</span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> segment, color <span class="kw">in</span> <span class="bu">zip</span>(segments, colors):</span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a>            segment_data <span class="op">=</span> full_data[full_data[<span class="st">'Segment'</span>] <span class="op">==</span> segment]</span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a>            axes[<span class="dv">0</span>, <span class="dv">1</span>].scatter(segment_data[<span class="st">'Income'</span>], segment_data[<span class="st">'Annual_Spending'</span>], </span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>                             alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span>segment, color<span class="op">=</span>color)</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Income vs Annual Spending'</span>)</span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Income ($)'</span>)</span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Annual Spending ($)'</span>)</span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].legend()</span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Education distribution</span></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a>        education_counts <span class="op">=</span> full_data[<span class="st">'Education'</span>].value_counts()</span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].pie(education_counts.values, labels<span class="op">=</span>education_counts.index, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>)</span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Education Distribution'</span>)</span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Segment distribution</span></span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a>        segment_counts <span class="op">=</span> full_data[<span class="st">'Segment'</span>].value_counts()</span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].bar(segment_counts.index, segment_counts.values, </span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span>[<span class="st">'lightcoral'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span>])</span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Customer Segment Distribution'</span>)</span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Segment'</span>)</span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5. Correlation heatmap</span></span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a>        correlation_data <span class="op">=</span> full_data[[<span class="st">'Age'</span>, <span class="st">'Income'</span>, <span class="st">'Annual_Spending'</span>, <span class="st">'Education_Encoded'</span>]].corr()</span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a>        im <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>].imshow(correlation_data.values, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Feature Correlation Heatmap'</span>)</span>
<span id="cb19-170"><a href="#cb19-170" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)))</span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)))</span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticklabels(correlation_data.columns, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_yticklabels(correlation_data.columns)</span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add correlation values</span></span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)):</span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)):</span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a>                axes[<span class="dv">1</span>, <span class="dv">1</span>].text(j, i, <span class="ss">f'</span><span class="sc">{</span>correlation_data<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">'</span>, </span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a>                               ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 6. Spending distribution by segment</span></span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> segment <span class="kw">in</span> segments:</span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a>            segment_data <span class="op">=</span> full_data[full_data[<span class="st">'Segment'</span>] <span class="op">==</span> segment]</span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a>            axes[<span class="dv">1</span>, <span class="dv">2</span>].hist(segment_data[<span class="st">'Annual_Spending'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span>segment, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_title(<span class="st">'Spending Distribution by Segment'</span>)</span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_xlabel(<span class="st">'Annual Spending ($)'</span>)</span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].legend()</span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_model(<span class="va">self</span>):</span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 4: Train machine learning model."""</span></span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Model Training ==="</span>)</span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.processed_data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.data_preprocessing()</span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> <span class="va">self</span>.processed_data[<span class="st">'features'</span>]</span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="va">self</span>.processed_data[<span class="st">'target'</span>]</span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Split data</span></span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a>        X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a>            X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y</span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Scale features</span></span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a>        X_train_scaled <span class="op">=</span> <span class="va">self</span>.scaler.fit_transform(X_train)</span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a>        X_test_scaled <span class="op">=</span> <span class="va">self</span>.scaler.transform(X_test)</span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train Random Forest model</span></span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a>            n_estimators<span class="op">=</span><span class="dv">100</span>, </span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a>            random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a>            max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a>            min_samples_split<span class="op">=</span><span class="dv">5</span></span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.fit(X_train_scaled, y_train)</span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cross-validation</span></span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a>        cv_scores <span class="op">=</span> cross_val_score(</span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model, X_train_scaled, y_train, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span></span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-227"><a href="#cb19-227" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-228"><a href="#cb19-228" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Cross-validation scores: </span><span class="sc">{</span>cv_scores<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Mean CV accuracy: </span><span class="sc">{</span>cv_scores<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss"> (+/- </span><span class="sc">{</span>cv_scores<span class="sc">.</span>std() <span class="op">*</span> <span class="dv">2</span><span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Test set evaluation</span></span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> <span class="va">self</span>.model.predict(X_test_scaled)</span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a>        test_accuracy <span class="op">=</span> (y_pred <span class="op">==</span> y_test).mean()</span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Test set accuracy: </span><span class="sc">{</span>test_accuracy<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Feature importance</span></span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a>        feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Feature'</span>: X.columns,</span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Importance'</span>: <span class="va">self</span>.model.feature_importances_</span>
<span id="cb19-241"><a href="#cb19-241" aria-hidden="true" tabindex="-1"></a>        }).sort_values(<span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-242"><a href="#cb19-242" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Feature Importance:"</span>)</span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(feature_importance)</span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Detailed classification report</span></span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Classification Report:"</span>)</span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: <span class="va">self</span>.model,</span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_accuracy'</span>: test_accuracy,</span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a>            <span class="st">'cv_scores'</span>: cv_scores,</span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a>            <span class="st">'feature_importance'</span>: feature_importance,</span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a>            <span class="st">'predictions'</span>: y_pred,</span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a>            <span class="st">'true_labels'</span>: y_test</span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-259"><a href="#cb19-259" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> model_evaluation(<span class="va">self</span>, results):</span>
<span id="cb19-260"><a href="#cb19-260" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 5: Evaluate model performance."""</span></span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Model Evaluation ==="</span>)</span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a>        y_true <span class="op">=</span> results[<span class="st">'true_labels'</span>]</span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> results[<span class="st">'predictions'</span>]</span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-266"><a href="#cb19-266" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Confusion matrix</span></span>
<span id="cb19-267"><a href="#cb19-267" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot confusion matrix</span></span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a>        sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a>                   xticklabels<span class="op">=</span><span class="va">self</span>.model.classes_,</span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a>                   yticklabels<span class="op">=</span><span class="va">self</span>.model.classes_)</span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">'Confusion Matrix'</span>)</span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Predicted'</span>)</span>
<span id="cb19-278"><a href="#cb19-278" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Actual'</span>)</span>
<span id="cb19-279"><a href="#cb19-279" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot feature importance</span></span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a>        feature_imp <span class="op">=</span> results[<span class="st">'feature_importance'</span>].head(<span class="dv">6</span>)</span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a>        plt.barh(feature_imp[<span class="st">'Feature'</span>], feature_imp[<span class="st">'Importance'</span>])</span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">'Top Feature Importance'</span>)</span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Importance'</span>)</span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_complete_project(<span class="va">self</span>):</span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Run the complete data science project."""</span></span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"🚀 Starting </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-294"><a href="#cb19-294" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 1: Load and explore data</span></span>
<span id="cb19-295"><a href="#cb19-295" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_and_explore_data()</span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 2: Preprocess data</span></span>
<span id="cb19-298"><a href="#cb19-298" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_preprocessing()</span>
<span id="cb19-299"><a href="#cb19-299" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 3: EDA</span></span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exploratory_data_analysis()</span>
<span id="cb19-302"><a href="#cb19-302" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-303"><a href="#cb19-303" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 4: Train model</span></span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>.train_model()</span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 5: Evaluate model</span></span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_evaluation(results)</span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">✅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss"> completed successfully!"</span>)</span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the complete data science project</span></span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a>project <span class="op">=</span> DataScienceProject(<span class="st">"Customer Segmentation Analysis"</span>)</span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> project.run_complete_project()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>🚀 Starting Customer Segmentation Analysis
=== Customer Segmentation Analysis: Data Exploration ===
Dataset shape: (2000, 5)

First 5 rows:
   Age        Income    Education  Annual_Spending   Segment
0   45  25910.688929     Bachelor      4506.997369  Standard
1   38  33783.934730  High School      5375.083199  Standard
2   47  24435.445449          PhD      4119.456022  Standard
3   58  31132.863212     Bachelor      6021.127439  Standard
4   37  14089.606354     Bachelor      4209.094848  Standard

Dataset info:
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2000 entries, 0 to 1999
Data columns (total 5 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   Age              2000 non-null   int64  
 1   Income           2000 non-null   float64
 2   Education        2000 non-null   object 
 3   Annual_Spending  2000 non-null   float64
 4   Segment          2000 non-null   object 
dtypes: float64(2), int64(1), object(2)
memory usage: 78.3+ KB
None

Basic statistics:
               Age         Income  Annual_Spending
count  2000.000000    2000.000000      2000.000000
mean     40.183000   41092.216981      6103.280641
std      11.526532   22249.067041      2353.038133
min      18.000000    8024.413988      1302.689761
25%      32.000000   25474.596521      4507.616427
50%      40.000000   36314.535117      5684.093388
75%      48.000000   50653.917258      7196.632244
max      80.000000  258620.975353     28054.752121

Segment distribution:
Segment
Standard    1352
Premium      341
Basic        307
Name: count, dtype: int64

=== Data Preprocessing ===
Missing values:
Age                0
Income             0
Education          0
Annual_Spending    0
Segment            0
dtype: int64
Features selected: ['Age', 'Income', 'Education_Encoded', 'Annual_Spending', 'Income_to_Age_Ratio', 'Spending_to_Income_Ratio']
Target variable: Segment
Processed data shape: (2000, 6)

=== Exploratory Data Analysis ===</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="12-data-science_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Model Training ===
Cross-validation scores: [1.         1.         0.99642857 1.         0.99642857]
Mean CV accuracy: 0.999 (+/- 0.003)
Test set accuracy: 1.000

Feature Importance:
                    Feature  Importance
3           Annual_Spending    0.644447
1                    Income    0.231089
4       Income_to_Age_Ratio    0.055393
5  Spending_to_Income_Ratio    0.034073
0                       Age    0.034009
2         Education_Encoded    0.000989

Classification Report:
              precision    recall  f1-score   support

       Basic       1.00      1.00      1.00        92
     Premium       1.00      1.00      1.00       102
    Standard       1.00      1.00      1.00       406

    accuracy                           1.00       600
   macro avg       1.00      1.00      1.00       600
weighted avg       1.00      1.00      1.00       600


=== Model Evaluation ===</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="12-data-science_files/figure-html/cell-9-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
✅ Customer Segmentation Analysis completed successfully!</code></pre>
</div>
</div>
</section>
</section>
<section id="self-review-questions" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="self-review-questions"><span class="header-section-number">6</span> Self-Review Questions</h2>
<section id="knowledge-check" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="knowledge-check"><span class="header-section-number">6.1</span> Knowledge Check</h3>
<ol type="1">
<li><strong>What are the core libraries in the Python data science ecosystem?</strong></li>
<li><strong>When would you use NumPy vs Pandas?</strong></li>
<li><strong>What’s the difference between supervised and unsupervised learning?</strong></li>
<li><strong>How do you handle missing data in a dataset?</strong></li>
<li><strong>What metrics would you use to evaluate a classification model?</strong></li>
</ol>
</section>
<section id="practical-exercises" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="practical-exercises"><span class="header-section-number">6.2</span> Practical Exercises</h3>
<ol type="1">
<li><strong>Data Cleaning Challenge</strong>: Clean a messy dataset with missing values and outliers</li>
<li><strong>Visualization Project</strong>: Create an interactive dashboard for sales data</li>
<li><strong>Prediction Model</strong>: Build a model to predict house prices</li>
<li><strong>Time Series Analysis</strong>: Analyze stock price trends and patterns</li>
</ol>
</section>
<section id="answers" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="answers"><span class="header-section-number">6.3</span> Answers</h3>
<ol type="1">
<li>NumPy (arrays), Pandas (dataframes), Matplotlib/Seaborn (visualization), Scikit-learn (ML)</li>
<li>NumPy for numerical computations; Pandas for data manipulation and analysis</li>
<li>Supervised has labeled data; unsupervised finds patterns in unlabeled data</li>
<li>Remove, impute with mean/median/mode, or use advanced imputation techniques</li>
<li>Accuracy, precision, recall, F1-score, ROC-AUC for classification</li>
</ol>
</section>
</section>
<section id="best-practices" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="best-practices"><span class="header-section-number">7</span> Best Practices</h2>
<ol type="1">
<li><strong>Start with data exploration</strong> - understand your data before modeling</li>
<li><strong>Clean data thoroughly</strong> - garbage in, garbage out</li>
<li><strong>Feature engineering</strong> - create meaningful features from raw data</li>
<li><strong>Cross-validation</strong> - properly evaluate model performance</li>
<li><strong>Document everything</strong> - reproducible analysis is crucial</li>
<li><strong>Version control</strong> - track data, code, and model versions</li>
</ol>
</section>
<section id="next-steps" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="next-steps"><span class="header-section-number">8</span> Next Steps</h2>
<p>Excellent! You now have a solid foundation in data science with Python. Next, we’ll explore <a href="13-web-development.qmd">Web Development</a> to learn how to build web applications with Streamlit and FastAPI.</p>
</section>
<section id="resources" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="resources"><span class="header-section-number">9</span> Resources</h2>
<ul>
<li><a href="https://pandas.pydata.org/docs/">Pandas Documentation</a></li>
<li><a href="https://numpy.org/doc/">NumPy Documentation</a></li>
<li><a href="https://matplotlib.org/stable/contents.html">Matplotlib Documentation</a></li>
<li><a href="https://scikit-learn.org/stable/">Scikit-learn Documentation</a></li>
<li><a href="https://www.kaggle.com/learn">Kaggle Learn</a> - Free micro-courses</li>
<li><a href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb23" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Science with Python</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Python is the leading language for data science, offering powerful libraries for data manipulation, analysis, visualization, and machine learning.</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Core Data Science Libraries</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">### NumPy - Numerical Computing</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create arrays and basic operations</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== NumPy Basics ==="</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create arrays</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"1D array: </span><span class="sc">{</span>arr1<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"2D array:</span><span class="ch">\n</span><span class="sc">{</span>arr2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Array shape: </span><span class="sc">{</span>arr2<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Array data type: </span><span class="sc">{</span>arr2<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Array operations</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Array operations:"</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation: </span><span class="sc">{</span>np<span class="sc">.</span>std(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Max value: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(arr1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise operations</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>squared <span class="op">=</span> arr1 <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Squared: </span><span class="sc">{</span>squared<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Boolean indexing</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Values &gt; 3: </span><span class="sc">{</span>arr1[arr1 <span class="op">&gt;</span> <span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical operations on 2D array</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">2D array statistics:"</span>)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum of each column: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">sum</span>(arr2, axis<span class="op">=</span><span class="dv">0</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean of each row: </span><span class="sc">{</span>np<span class="sc">.</span>mean(arr2, axis<span class="op">=</span><span class="dv">1</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pandas - Data Manipulation</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Pandas Basics ==="</span>)</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'Diana'</span>, <span class="st">'Eve'</span>],</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">28</span>, <span class="dv">32</span>],</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'New York'</span>, <span class="st">'London'</span>, <span class="st">'Tokyo'</span>, <span class="st">'Paris'</span>, <span class="st">'Sydney'</span>],</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Salary'</span>: [<span class="dv">70000</span>, <span class="dv">80000</span>, <span class="dv">90000</span>, <span class="dv">65000</span>, <span class="dv">75000</span>],</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Department'</span>: [<span class="st">'Engineering'</span>, <span class="st">'Marketing'</span>, <span class="st">'Engineering'</span>, <span class="st">'HR'</span>, <span class="st">'Marketing'</span>]</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sample DataFrame:"</span>)</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DataFrame info:"</span>)</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Columns: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Data types:</span><span class="ch">\n</span><span class="sc">{</span>df<span class="sc">.</span>dtypes<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic operations</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Basic statistics:"</span>)</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering data</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Engineering employees:"</span>)</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>engineering <span class="op">=</span> df[df[<span class="st">'Department'</span>] <span class="op">==</span> <span class="st">'Engineering'</span>]</span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(engineering)</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping and aggregation</span></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Salary by department:"</span>)</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>dept_salary <span class="op">=</span> df.groupby(<span class="st">'Department'</span>)[<span class="st">'Salary'</span>].agg([<span class="st">'mean'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>])</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dept_salary)</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding new columns</span></span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Salary_Rank'</span>] <span class="op">=</span> df[<span class="st">'Salary'</span>].rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Age_Group'</span>] <span class="op">=</span> pd.cut(df[<span class="st">'Age'</span>], bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">100</span>], labels<span class="op">=</span>[<span class="st">'Young'</span>, <span class="st">'Mid'</span>, <span class="st">'Senior'</span>])</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DataFrame with new columns:"</span>)</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[[<span class="st">'Name'</span>, <span class="st">'Age'</span>, <span class="st">'Age_Group'</span>, <span class="st">'Salary'</span>, <span class="st">'Salary_Rank'</span>]])</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with Your Own Data Files</span></span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## 📁 Upload Your Own CSV Files</span></span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>With **Quarto Drop**, you can drag and drop your own CSV files directly into the browser! Try uploading a CSV file in the area below and analyze it with Pandas.</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: file-upload</span></span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| drop: true</span></span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| filename: data.csv</span></span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Drag and drop your CSV file here to upload it</span></span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-114"><a href="#cb23-114" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-115"><a href="#cb23-115" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb23-116"><a href="#cb23-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-117"><a href="#cb23-117" aria-hidden="true" tabindex="-1"></a><span class="co"># This will work when you drop a CSV file</span></span>
<span id="cb23-118"><a href="#cb23-118" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb23-119"><a href="#cb23-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the uploaded file</span></span>
<span id="cb23-120"><a href="#cb23-120" aria-hidden="true" tabindex="-1"></a>    df_uploaded <span class="op">=</span> pd.read_csv(<span class="st">'data.csv'</span>)</span>
<span id="cb23-121"><a href="#cb23-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-122"><a href="#cb23-122" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"=== Your Uploaded Data ==="</span>)</span>
<span id="cb23-123"><a href="#cb23-123" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span>df_uploaded<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-124"><a href="#cb23-124" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Columns: </span><span class="sc">{</span><span class="bu">list</span>(df_uploaded.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-125"><a href="#cb23-125" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">First 5 rows:"</span>)</span>
<span id="cb23-126"><a href="#cb23-126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_uploaded.head())</span>
<span id="cb23-127"><a href="#cb23-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-128"><a href="#cb23-128" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Basic statistics:"</span>)</span>
<span id="cb23-129"><a href="#cb23-129" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_uploaded.describe())</span>
<span id="cb23-130"><a href="#cb23-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-131"><a href="#cb23-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show data types</span></span>
<span id="cb23-132"><a href="#cb23-132" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Data types:"</span>)</span>
<span id="cb23-133"><a href="#cb23-133" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df_uploaded.dtypes)</span>
<span id="cb23-134"><a href="#cb23-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-135"><a href="#cb23-135" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb23-136"><a href="#cb23-136" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"📁 No file uploaded yet. Drag and drop a CSV file above to analyze it!"</span>)</span>
<span id="cb23-137"><a href="#cb23-137" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"You can create a simple CSV file with columns like: Name,Age,City,Salary"</span>)</span>
<span id="cb23-138"><a href="#cb23-138" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb23-139"><a href="#cb23-139" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Error reading file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-140"><a href="#cb23-140" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Make sure your file is a valid CSV format."</span>)</span>
<span id="cb23-141"><a href="#cb23-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-142"><a href="#cb23-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-143"><a href="#cb23-143" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb23-144"><a href="#cb23-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## 🎯 Try This</span></span>
<span id="cb23-145"><a href="#cb23-145" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a simple CSV file on your computer with data like:</span>
<span id="cb23-146"><a href="#cb23-146" aria-hidden="true" tabindex="-1"></a>   <span class="in">```</span></span>
<span id="cb23-147"><a href="#cb23-147" aria-hidden="true" tabindex="-1"></a><span class="in">   Name,Age,Department,Salary</span></span>
<span id="cb23-148"><a href="#cb23-148" aria-hidden="true" tabindex="-1"></a><span class="in">   John,25,Engineering,70000</span></span>
<span id="cb23-149"><a href="#cb23-149" aria-hidden="true" tabindex="-1"></a><span class="in">   Jane,30,Marketing,65000</span></span>
<span id="cb23-150"><a href="#cb23-150" aria-hidden="true" tabindex="-1"></a><span class="in">   ```</span></span>
<span id="cb23-151"><a href="#cb23-151" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Drag and drop it into the code area above</span>
<span id="cb23-152"><a href="#cb23-152" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The code will automatically analyze your data!</span>
<span id="cb23-153"><a href="#cb23-153" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-154"><a href="#cb23-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-155"><a href="#cb23-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Matplotlib - Data Visualization</span></span>
<span id="cb23-156"><a href="#cb23-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-157"><a href="#cb23-157" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb23-158"><a href="#cb23-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## 📊 Interactive Plotting</span></span>
<span id="cb23-159"><a href="#cb23-159" aria-hidden="true" tabindex="-1"></a>With **Quarto Live**, you can modify the plotting code below and see the results instantly! Try changing colors, plot types, or data values to experiment with different visualizations.</span>
<span id="cb23-160"><a href="#cb23-160" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-161"><a href="#cb23-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-164"><a href="#cb23-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-165"><a href="#cb23-165" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-166"><a href="#cb23-166" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-167"><a href="#cb23-167" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-168"><a href="#cb23-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-169"><a href="#cb23-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure matplotlib for Quarto</span></span>
<span id="cb23-170"><a href="#cb23-170" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>)</span>
<span id="cb23-171"><a href="#cb23-171" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb23-172"><a href="#cb23-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-173"><a href="#cb23-173" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Interactive Data Visualization ==="</span>)</span>
<span id="cb23-174"><a href="#cb23-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-175"><a href="#cb23-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive example: Create your own data</span></span>
<span id="cb23-176"><a href="#cb23-176" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>)</span>
<span id="cb23-177"><a href="#cb23-177" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(x) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">50</span>)  <span class="co"># Try changing the multiplier!</span></span>
<span id="cb23-178"><a href="#cb23-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-179"><a href="#cb23-179" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-180"><a href="#cb23-180" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, <span class="st">'bo-'</span>, markersize<span class="op">=</span><span class="dv">4</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)  <span class="co"># Try different colors!</span></span>
<span id="cb23-181"><a href="#cb23-181" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Interactive Plot - Modify and Run!'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb23-182"><a href="#cb23-182" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X values'</span>)</span>
<span id="cb23-183"><a href="#cb23-183" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y values'</span>) </span>
<span id="cb23-184"><a href="#cb23-184" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-185"><a href="#cb23-185" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb23-186"><a href="#cb23-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-187"><a href="#cb23-187" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Try modifying the plot above - change colors, markers, or the mathematical function!"</span>)</span>
<span id="cb23-188"><a href="#cb23-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-189"><a href="#cb23-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb23-190"><a href="#cb23-190" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb23-191"><a href="#cb23-191" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.date_range(<span class="st">'2023-01-01'</span>, periods<span class="op">=</span><span class="dv">100</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb23-192"><a href="#cb23-192" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.cumsum(np.random.randn(<span class="dv">100</span>)) <span class="op">+</span> <span class="dv">100</span></span>
<span id="cb23-193"><a href="#cb23-193" aria-hidden="true" tabindex="-1"></a>sales_data <span class="op">=</span> pd.DataFrame({<span class="st">'Date'</span>: dates, <span class="st">'Sales'</span>: values})</span>
<span id="cb23-194"><a href="#cb23-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-195"><a href="#cb23-195" aria-hidden="true" tabindex="-1"></a><span class="co"># Line plot</span></span>
<span id="cb23-196"><a href="#cb23-196" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb23-197"><a href="#cb23-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-198"><a href="#cb23-198" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb23-199"><a href="#cb23-199" aria-hidden="true" tabindex="-1"></a>plt.plot(sales_data[<span class="st">'Date'</span>], sales_data[<span class="st">'Sales'</span>], linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb23-200"><a href="#cb23-200" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sales Over Time'</span>)</span>
<span id="cb23-201"><a href="#cb23-201" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb23-202"><a href="#cb23-202" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Sales ($)'</span>)</span>
<span id="cb23-203"><a href="#cb23-203" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-204"><a href="#cb23-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-205"><a href="#cb23-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb23-206"><a href="#cb23-206" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb23-207"><a href="#cb23-207" aria-hidden="true" tabindex="-1"></a>plt.hist(sales_data[<span class="st">'Sales'</span>], bins<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span><span class="st">'green'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb23-208"><a href="#cb23-208" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sales Distribution'</span>)</span>
<span id="cb23-209"><a href="#cb23-209" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Sales ($)'</span>)</span>
<span id="cb23-210"><a href="#cb23-210" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb23-211"><a href="#cb23-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-212"><a href="#cb23-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with categories</span></span>
<span id="cb23-213"><a href="#cb23-213" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>]</span>
<span id="cb23-214"><a href="#cb23-214" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.randn(<span class="dv">150</span>)</span>
<span id="cb23-215"><a href="#cb23-215" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.randn(<span class="dv">150</span>)</span>
<span id="cb23-216"><a href="#cb23-216" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> np.random.choice(categories, <span class="dv">150</span>)</span>
<span id="cb23-217"><a href="#cb23-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-218"><a href="#cb23-218" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-219"><a href="#cb23-219" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category <span class="kw">in</span> categories:</span>
<span id="cb23-220"><a href="#cb23-220" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> colors <span class="op">==</span> category</span>
<span id="cb23-221"><a href="#cb23-221" aria-hidden="true" tabindex="-1"></a>    plt.scatter(x[mask], y[mask], label<span class="op">=</span><span class="ss">f'Category </span><span class="sc">{</span>category<span class="sc">}</span><span class="ss">'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb23-222"><a href="#cb23-222" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot by Category'</span>)</span>
<span id="cb23-223"><a href="#cb23-223" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X Value'</span>)</span>
<span id="cb23-224"><a href="#cb23-224" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y Value'</span>)</span>
<span id="cb23-225"><a href="#cb23-225" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb23-226"><a href="#cb23-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-227"><a href="#cb23-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb23-228"><a href="#cb23-228" aria-hidden="true" tabindex="-1"></a>departments <span class="op">=</span> [<span class="st">'Engineering'</span>, <span class="st">'Marketing'</span>, <span class="st">'HR'</span>, <span class="st">'Sales'</span>]</span>
<span id="cb23-229"><a href="#cb23-229" aria-hidden="true" tabindex="-1"></a>avg_salaries <span class="op">=</span> [<span class="dv">85000</span>, <span class="dv">72000</span>, <span class="dv">65000</span>, <span class="dv">78000</span>]</span>
<span id="cb23-230"><a href="#cb23-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-231"><a href="#cb23-231" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb23-232"><a href="#cb23-232" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> plt.bar(departments, avg_salaries, color<span class="op">=</span>[<span class="st">'skyblue'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightcoral'</span>, <span class="st">'gold'</span>])</span>
<span id="cb23-233"><a href="#cb23-233" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Average Salary by Department'</span>)</span>
<span id="cb23-234"><a href="#cb23-234" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Department'</span>)</span>
<span id="cb23-235"><a href="#cb23-235" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Salary ($)'</span>)</span>
<span id="cb23-236"><a href="#cb23-236" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-237"><a href="#cb23-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-238"><a href="#cb23-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Add value labels on bars</span></span>
<span id="cb23-239"><a href="#cb23-239" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, salary <span class="kw">in</span> <span class="bu">zip</span>(bars, avg_salaries):</span>
<span id="cb23-240"><a href="#cb23-240" aria-hidden="true" tabindex="-1"></a>    plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="dv">2</span>, bar.get_height() <span class="op">+</span> <span class="dv">1000</span>,</span>
<span id="cb23-241"><a href="#cb23-241" aria-hidden="true" tabindex="-1"></a>             <span class="ss">f'$</span><span class="sc">{</span>salary<span class="sc">:,}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb23-242"><a href="#cb23-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-243"><a href="#cb23-243" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-244"><a href="#cb23-244" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb23-245"><a href="#cb23-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-246"><a href="#cb23-246" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Visualization plots created successfully!"</span>)</span>
<span id="cb23-247"><a href="#cb23-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-248"><a href="#cb23-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-249"><a href="#cb23-249" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working with Different File Formats</span></span>
<span id="cb23-250"><a href="#cb23-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-251"><a href="#cb23-251" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb23-252"><a href="#cb23-252" aria-hidden="true" tabindex="-1"></a><span class="fu">## 📊 Upload Excel and Other Data Files  </span></span>
<span id="cb23-253"><a href="#cb23-253" aria-hidden="true" tabindex="-1"></a>Beyond CSV files, you can also upload Excel files (.xlsx), JSON files, and other formats for analysis. Try dropping different file types below!</span>
<span id="cb23-254"><a href="#cb23-254" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb23-255"><a href="#cb23-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-258"><a href="#cb23-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-259"><a href="#cb23-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: multi-file-upload</span></span>
<span id="cb23-260"><a href="#cb23-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| drop: true</span></span>
<span id="cb23-261"><a href="#cb23-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| filename: datafile</span></span>
<span id="cb23-262"><a href="#cb23-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-263"><a href="#cb23-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Drag and drop Excel, JSON, or other data files here</span></span>
<span id="cb23-264"><a href="#cb23-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-265"><a href="#cb23-265" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-266"><a href="#cb23-266" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb23-267"><a href="#cb23-267" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb23-268"><a href="#cb23-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-269"><a href="#cb23-269" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_uploaded_file(filename):</span>
<span id="cb23-270"><a href="#cb23-270" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Analyze different types of uploaded files"""</span></span>
<span id="cb23-271"><a href="#cb23-271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb23-272"><a href="#cb23-272" aria-hidden="true" tabindex="-1"></a>        file_ext <span class="op">=</span> os.path.splitext(filename)[<span class="dv">1</span>].lower()</span>
<span id="cb23-273"><a href="#cb23-273" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-274"><a href="#cb23-274" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> file_ext <span class="op">==</span> <span class="st">'.csv'</span>:</span>
<span id="cb23-275"><a href="#cb23-275" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.read_csv(filename)</span>
<span id="cb23-276"><a href="#cb23-276" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"📊 CSV file loaded: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-277"><a href="#cb23-277" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-278"><a href="#cb23-278" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> file_ext <span class="kw">in</span> [<span class="st">'.xlsx'</span>, <span class="st">'.xls'</span>]:</span>
<span id="cb23-279"><a href="#cb23-279" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.read_excel(filename)</span>
<span id="cb23-280"><a href="#cb23-280" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"📈 Excel file loaded: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-281"><a href="#cb23-281" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-282"><a href="#cb23-282" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> file_ext <span class="op">==</span> <span class="st">'.json'</span>:</span>
<span id="cb23-283"><a href="#cb23-283" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb23-284"><a href="#cb23-284" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb23-285"><a href="#cb23-285" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> pd.json_normalize(data)</span>
<span id="cb23-286"><a href="#cb23-286" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"🔗 JSON file loaded: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-287"><a href="#cb23-287" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-288"><a href="#cb23-288" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb23-289"><a href="#cb23-289" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"❌ Unsupported file type: </span><span class="sc">{</span>file_ext<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-290"><a href="#cb23-290" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Supported formats: CSV (.csv), Excel (.xlsx, .xls), JSON (.json)"</span>)</span>
<span id="cb23-291"><a href="#cb23-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-292"><a href="#cb23-292" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-293"><a href="#cb23-293" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Analyze the loaded data</span></span>
<span id="cb23-294"><a href="#cb23-294" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== File Analysis ==="</span>)</span>
<span id="cb23-295"><a href="#cb23-295" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-296"><a href="#cb23-296" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Columns: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-297"><a href="#cb23-297" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Memory usage: </span><span class="sc">{</span>df<span class="sc">.</span>memory_usage(deep<span class="op">=</span><span class="va">True</span>)<span class="sc">.</span><span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1024</span><span class="sc">:.1f}</span><span class="ss"> KB"</span>)</span>
<span id="cb23-298"><a href="#cb23-298" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-299"><a href="#cb23-299" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== First 3 rows ==="</span>)</span>
<span id="cb23-300"><a href="#cb23-300" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(df.head(<span class="dv">3</span>))</span>
<span id="cb23-301"><a href="#cb23-301" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-302"><a href="#cb23-302" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Data types ==="</span>)</span>
<span id="cb23-303"><a href="#cb23-303" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(df.dtypes)</span>
<span id="cb23-304"><a href="#cb23-304" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-305"><a href="#cb23-305" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check for missing values</span></span>
<span id="cb23-306"><a href="#cb23-306" aria-hidden="true" tabindex="-1"></a>        missing_values <span class="op">=</span> df.isnull().<span class="bu">sum</span>()</span>
<span id="cb23-307"><a href="#cb23-307" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> missing_values.<span class="bu">any</span>():</span>
<span id="cb23-308"><a href="#cb23-308" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Missing values ==="</span>)</span>
<span id="cb23-309"><a href="#cb23-309" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(missing_values[missing_values <span class="op">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb23-310"><a href="#cb23-310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb23-311"><a href="#cb23-311" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✅ No missing values found!"</span>)</span>
<span id="cb23-312"><a href="#cb23-312" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-313"><a href="#cb23-313" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Quick statistics for numeric columns</span></span>
<span id="cb23-314"><a href="#cb23-314" aria-hidden="true" tabindex="-1"></a>        numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb23-315"><a href="#cb23-315" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(numeric_cols) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb23-316"><a href="#cb23-316" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Statistics for numeric columns ==="</span>)</span>
<span id="cb23-317"><a href="#cb23-317" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(df[numeric_cols].describe())</span>
<span id="cb23-318"><a href="#cb23-318" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-319"><a href="#cb23-319" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb23-320"><a href="#cb23-320" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-321"><a href="#cb23-321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb23-322"><a href="#cb23-322" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"❌ Error processing file: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-323"><a href="#cb23-323" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Please ensure your file is in a valid format."</span>)</span>
<span id="cb23-324"><a href="#cb23-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-325"><a href="#cb23-325" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a file was uploaded</span></span>
<span id="cb23-326"><a href="#cb23-326" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb23-327"><a href="#cb23-327" aria-hidden="true" tabindex="-1"></a>    uploaded_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(<span class="st">'.'</span>) <span class="cf">if</span> f <span class="op">!=</span> <span class="st">'datafile'</span>]</span>
<span id="cb23-328"><a href="#cb23-328" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> uploaded_files:</span>
<span id="cb23-329"><a href="#cb23-329" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> uploaded_files:</span>
<span id="cb23-330"><a href="#cb23-330" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">file</span>.startswith(<span class="st">'.'</span>):  <span class="co"># Skip hidden files</span></span>
<span id="cb23-331"><a href="#cb23-331" aria-hidden="true" tabindex="-1"></a>                df_analysis <span class="op">=</span> analyze_uploaded_file(<span class="bu">file</span>)</span>
<span id="cb23-332"><a href="#cb23-332" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb23-333"><a href="#cb23-333" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb23-334"><a href="#cb23-334" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"📁 No file uploaded yet."</span>)</span>
<span id="cb23-335"><a href="#cb23-335" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Supported formats:"</span>)</span>
<span id="cb23-336"><a href="#cb23-336" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"• CSV files (.csv)"</span>)</span>
<span id="cb23-337"><a href="#cb23-337" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"• Excel files (.xlsx, .xls)"</span>)  </span>
<span id="cb23-338"><a href="#cb23-338" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"• JSON files (.json)"</span>)</span>
<span id="cb23-339"><a href="#cb23-339" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Drag and drop a file above to analyze it!"</span>)</span>
<span id="cb23-340"><a href="#cb23-340" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-341"><a href="#cb23-341" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb23-342"><a href="#cb23-342" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"📁 Drag and drop a data file above to get started!"</span>)</span>
<span id="cb23-343"><a href="#cb23-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-344"><a href="#cb23-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-345"><a href="#cb23-345" aria-hidden="true" tabindex="-1"></a><span class="fu">## Real-World Data Science Project</span></span>
<span id="cb23-346"><a href="#cb23-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-347"><a href="#cb23-347" aria-hidden="true" tabindex="-1"></a><span class="fu">### Project: Sales Data Analysis</span></span>
<span id="cb23-348"><a href="#cb23-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-351"><a href="#cb23-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-352"><a href="#cb23-352" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-353"><a href="#cb23-353" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-354"><a href="#cb23-354" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-355"><a href="#cb23-355" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timedelta</span>
<span id="cb23-356"><a href="#cb23-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-357"><a href="#cb23-357" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SalesAnalyzer:</span>
<span id="cb23-358"><a href="#cb23-358" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Comprehensive sales data analyzer."""</span></span>
<span id="cb23-359"><a href="#cb23-359" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-360"><a href="#cb23-360" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb23-361"><a href="#cb23-361" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-362"><a href="#cb23-362" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.summary_stats <span class="op">=</span> {}</span>
<span id="cb23-363"><a href="#cb23-363" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-364"><a href="#cb23-364" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_sample_data(<span class="va">self</span>, num_records: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1000</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb23-365"><a href="#cb23-365" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate realistic sales data for analysis."""</span></span>
<span id="cb23-366"><a href="#cb23-366" aria-hidden="true" tabindex="-1"></a>        np.random.seed(<span class="dv">42</span>)</span>
<span id="cb23-367"><a href="#cb23-367" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-368"><a href="#cb23-368" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Date range</span></span>
<span id="cb23-369"><a href="#cb23-369" aria-hidden="true" tabindex="-1"></a>        start_date <span class="op">=</span> datetime(<span class="dv">2023</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb23-370"><a href="#cb23-370" aria-hidden="true" tabindex="-1"></a>        end_date <span class="op">=</span> datetime(<span class="dv">2023</span>, <span class="dv">12</span>, <span class="dv">31</span>)</span>
<span id="cb23-371"><a href="#cb23-371" aria-hidden="true" tabindex="-1"></a>        dates <span class="op">=</span> pd.date_range(start_date, end_date, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb23-372"><a href="#cb23-372" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-373"><a href="#cb23-373" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate data</span></span>
<span id="cb23-374"><a href="#cb23-374" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> []</span>
<span id="cb23-375"><a href="#cb23-375" aria-hidden="true" tabindex="-1"></a>        products <span class="op">=</span> [<span class="st">'Laptop'</span>, <span class="st">'Desktop'</span>, <span class="st">'Tablet'</span>, <span class="st">'Phone'</span>, <span class="st">'Monitor'</span>, <span class="st">'Keyboard'</span>, <span class="st">'Mouse'</span>]</span>
<span id="cb23-376"><a href="#cb23-376" aria-hidden="true" tabindex="-1"></a>        regions <span class="op">=</span> [<span class="st">'North'</span>, <span class="st">'South'</span>, <span class="st">'East'</span>, <span class="st">'West'</span>, <span class="st">'Central'</span>]</span>
<span id="cb23-377"><a href="#cb23-377" aria-hidden="true" tabindex="-1"></a>        sales_reps <span class="op">=</span> [<span class="ss">f'Rep_</span><span class="sc">{</span>i<span class="sc">:02d}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">21</span>)]</span>
<span id="cb23-378"><a href="#cb23-378" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-379"><a href="#cb23-379" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_records):</span>
<span id="cb23-380"><a href="#cb23-380" aria-hidden="true" tabindex="-1"></a>            date <span class="op">=</span> np.random.choice(dates)</span>
<span id="cb23-381"><a href="#cb23-381" aria-hidden="true" tabindex="-1"></a>            product <span class="op">=</span> np.random.choice(products)</span>
<span id="cb23-382"><a href="#cb23-382" aria-hidden="true" tabindex="-1"></a>            region <span class="op">=</span> np.random.choice(regions)</span>
<span id="cb23-383"><a href="#cb23-383" aria-hidden="true" tabindex="-1"></a>            sales_rep <span class="op">=</span> np.random.choice(sales_reps)</span>
<span id="cb23-384"><a href="#cb23-384" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-385"><a href="#cb23-385" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Product-specific pricing</span></span>
<span id="cb23-386"><a href="#cb23-386" aria-hidden="true" tabindex="-1"></a>            base_prices <span class="op">=</span> {</span>
<span id="cb23-387"><a href="#cb23-387" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Laptop'</span>: <span class="dv">1200</span>, <span class="st">'Desktop'</span>: <span class="dv">800</span>, <span class="st">'Tablet'</span>: <span class="dv">400</span>,</span>
<span id="cb23-388"><a href="#cb23-388" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Phone'</span>: <span class="dv">600</span>, <span class="st">'Monitor'</span>: <span class="dv">300</span>, <span class="st">'Keyboard'</span>: <span class="dv">80</span>, <span class="st">'Mouse'</span>: <span class="dv">40</span></span>
<span id="cb23-389"><a href="#cb23-389" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb23-390"><a href="#cb23-390" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-391"><a href="#cb23-391" aria-hidden="true" tabindex="-1"></a>            base_price <span class="op">=</span> base_prices[product]</span>
<span id="cb23-392"><a href="#cb23-392" aria-hidden="true" tabindex="-1"></a>            quantity <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb23-393"><a href="#cb23-393" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-394"><a href="#cb23-394" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add some seasonality and randomness</span></span>
<span id="cb23-395"><a href="#cb23-395" aria-hidden="true" tabindex="-1"></a>            month_factor <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> np.sin(<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> pd.Timestamp(date).month <span class="op">/</span> <span class="dv">12</span>)</span>
<span id="cb23-396"><a href="#cb23-396" aria-hidden="true" tabindex="-1"></a>            price <span class="op">=</span> base_price <span class="op">*</span> month_factor <span class="op">*</span> np.random.uniform(<span class="fl">0.8</span>, <span class="fl">1.2</span>)</span>
<span id="cb23-397"><a href="#cb23-397" aria-hidden="true" tabindex="-1"></a>            revenue <span class="op">=</span> price <span class="op">*</span> quantity</span>
<span id="cb23-398"><a href="#cb23-398" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-399"><a href="#cb23-399" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Simulate costs (60-80% of revenue)</span></span>
<span id="cb23-400"><a href="#cb23-400" aria-hidden="true" tabindex="-1"></a>            cost_ratio <span class="op">=</span> np.random.uniform(<span class="fl">0.6</span>, <span class="fl">0.8</span>)</span>
<span id="cb23-401"><a href="#cb23-401" aria-hidden="true" tabindex="-1"></a>            cost <span class="op">=</span> revenue <span class="op">*</span> cost_ratio</span>
<span id="cb23-402"><a href="#cb23-402" aria-hidden="true" tabindex="-1"></a>            profit <span class="op">=</span> revenue <span class="op">-</span> cost</span>
<span id="cb23-403"><a href="#cb23-403" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-404"><a href="#cb23-404" aria-hidden="true" tabindex="-1"></a>            data.append({</span>
<span id="cb23-405"><a href="#cb23-405" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Date'</span>: date,</span>
<span id="cb23-406"><a href="#cb23-406" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Product'</span>: product,</span>
<span id="cb23-407"><a href="#cb23-407" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Region'</span>: region,</span>
<span id="cb23-408"><a href="#cb23-408" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Sales_Rep'</span>: sales_rep,</span>
<span id="cb23-409"><a href="#cb23-409" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Quantity'</span>: quantity,</span>
<span id="cb23-410"><a href="#cb23-410" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Unit_Price'</span>: price,</span>
<span id="cb23-411"><a href="#cb23-411" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Revenue'</span>: revenue,</span>
<span id="cb23-412"><a href="#cb23-412" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Cost'</span>: cost,</span>
<span id="cb23-413"><a href="#cb23-413" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Profit'</span>: profit</span>
<span id="cb23-414"><a href="#cb23-414" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb23-415"><a href="#cb23-415" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-416"><a href="#cb23-416" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb23-417"><a href="#cb23-417" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'Date'</span>])</span>
<span id="cb23-418"><a href="#cb23-418" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Month'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.month</span>
<span id="cb23-419"><a href="#cb23-419" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Quarter'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.quarter</span>
<span id="cb23-420"><a href="#cb23-420" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Day_of_Week'</span>] <span class="op">=</span> df[<span class="st">'Date'</span>].dt.day_name()</span>
<span id="cb23-421"><a href="#cb23-421" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-422"><a href="#cb23-422" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> df</span>
<span id="cb23-423"><a href="#cb23-423" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Generated </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss"> sales records"</span>)</span>
<span id="cb23-424"><a href="#cb23-424" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df</span>
<span id="cb23-425"><a href="#cb23-425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-426"><a href="#cb23-426" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> basic_analysis(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb23-427"><a href="#cb23-427" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Perform basic statistical analysis."""</span></span>
<span id="cb23-428"><a href="#cb23-428" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-429"><a href="#cb23-429" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No data available. Generate data first."</span>)</span>
<span id="cb23-430"><a href="#cb23-430" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-431"><a href="#cb23-431" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb23-432"><a href="#cb23-432" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-433"><a href="#cb23-433" aria-hidden="true" tabindex="-1"></a>        analysis <span class="op">=</span> {</span>
<span id="cb23-434"><a href="#cb23-434" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_records'</span>: <span class="bu">len</span>(df),</span>
<span id="cb23-435"><a href="#cb23-435" aria-hidden="true" tabindex="-1"></a>            <span class="st">'date_range'</span>: (df[<span class="st">'Date'</span>].<span class="bu">min</span>(), df[<span class="st">'Date'</span>].<span class="bu">max</span>()),</span>
<span id="cb23-436"><a href="#cb23-436" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_revenue'</span>: df[<span class="st">'Revenue'</span>].<span class="bu">sum</span>(),</span>
<span id="cb23-437"><a href="#cb23-437" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_profit'</span>: df[<span class="st">'Profit'</span>].<span class="bu">sum</span>(),</span>
<span id="cb23-438"><a href="#cb23-438" aria-hidden="true" tabindex="-1"></a>            <span class="st">'avg_order_value'</span>: df[<span class="st">'Revenue'</span>].mean(),</span>
<span id="cb23-439"><a href="#cb23-439" aria-hidden="true" tabindex="-1"></a>            <span class="st">'profit_margin'</span>: (df[<span class="st">'Profit'</span>].<span class="bu">sum</span>() <span class="op">/</span> df[<span class="st">'Revenue'</span>].<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb23-440"><a href="#cb23-440" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_product'</span>: df.groupby(<span class="st">'Product'</span>)[<span class="st">'Revenue'</span>].<span class="bu">sum</span>().idxmax(),</span>
<span id="cb23-441"><a href="#cb23-441" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_region'</span>: df.groupby(<span class="st">'Region'</span>)[<span class="st">'Revenue'</span>].<span class="bu">sum</span>().idxmax(),</span>
<span id="cb23-442"><a href="#cb23-442" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top_sales_rep'</span>: df.groupby(<span class="st">'Sales_Rep'</span>)[<span class="st">'Revenue'</span>].<span class="bu">sum</span>().idxmax()</span>
<span id="cb23-443"><a href="#cb23-443" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-444"><a href="#cb23-444" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-445"><a href="#cb23-445" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.summary_stats <span class="op">=</span> analysis</span>
<span id="cb23-446"><a href="#cb23-446" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> analysis</span>
<span id="cb23-447"><a href="#cb23-447" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-448"><a href="#cb23-448" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> time_series_analysis(<span class="va">self</span>):</span>
<span id="cb23-449"><a href="#cb23-449" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze sales trends over time."""</span></span>
<span id="cb23-450"><a href="#cb23-450" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-451"><a href="#cb23-451" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-452"><a href="#cb23-452" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-453"><a href="#cb23-453" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb23-454"><a href="#cb23-454" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-455"><a href="#cb23-455" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Monthly analysis</span></span>
<span id="cb23-456"><a href="#cb23-456" aria-hidden="true" tabindex="-1"></a>        monthly_sales <span class="op">=</span> df.groupby(df[<span class="st">'Date'</span>].dt.to_period(<span class="st">'M'</span>)).agg({</span>
<span id="cb23-457"><a href="#cb23-457" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: <span class="st">'sum'</span>,</span>
<span id="cb23-458"><a href="#cb23-458" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: <span class="st">'sum'</span>,</span>
<span id="cb23-459"><a href="#cb23-459" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span></span>
<span id="cb23-460"><a href="#cb23-460" aria-hidden="true" tabindex="-1"></a>        }).reset_index()</span>
<span id="cb23-461"><a href="#cb23-461" aria-hidden="true" tabindex="-1"></a>        monthly_sales[<span class="st">'Date'</span>] <span class="op">=</span> monthly_sales[<span class="st">'Date'</span>].dt.to_timestamp()</span>
<span id="cb23-462"><a href="#cb23-462" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-463"><a href="#cb23-463" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Quarterly analysis</span></span>
<span id="cb23-464"><a href="#cb23-464" aria-hidden="true" tabindex="-1"></a>        quarterly_sales <span class="op">=</span> df.groupby(<span class="st">'Quarter'</span>).agg({</span>
<span id="cb23-465"><a href="#cb23-465" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: <span class="st">'sum'</span>,</span>
<span id="cb23-466"><a href="#cb23-466" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: <span class="st">'sum'</span>,</span>
<span id="cb23-467"><a href="#cb23-467" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span></span>
<span id="cb23-468"><a href="#cb23-468" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb23-469"><a href="#cb23-469" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-470"><a href="#cb23-470" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Day of week analysis</span></span>
<span id="cb23-471"><a href="#cb23-471" aria-hidden="true" tabindex="-1"></a>        dow_sales <span class="op">=</span> df.groupby(<span class="st">'Day_of_Week'</span>).agg({</span>
<span id="cb23-472"><a href="#cb23-472" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: <span class="st">'mean'</span>,</span>
<span id="cb23-473"><a href="#cb23-473" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'mean'</span></span>
<span id="cb23-474"><a href="#cb23-474" aria-hidden="true" tabindex="-1"></a>        }).reindex([<span class="st">'Monday'</span>, <span class="st">'Tuesday'</span>, <span class="st">'Wednesday'</span>, <span class="st">'Thursday'</span>, <span class="st">'Friday'</span>, <span class="st">'Saturday'</span>, <span class="st">'Sunday'</span>])</span>
<span id="cb23-475"><a href="#cb23-475" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-476"><a href="#cb23-476" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb23-477"><a href="#cb23-477" aria-hidden="true" tabindex="-1"></a>            <span class="st">'monthly'</span>: monthly_sales,</span>
<span id="cb23-478"><a href="#cb23-478" aria-hidden="true" tabindex="-1"></a>            <span class="st">'quarterly'</span>: quarterly_sales,</span>
<span id="cb23-479"><a href="#cb23-479" aria-hidden="true" tabindex="-1"></a>            <span class="st">'day_of_week'</span>: dow_sales</span>
<span id="cb23-480"><a href="#cb23-480" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-481"><a href="#cb23-481" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-482"><a href="#cb23-482" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> product_analysis(<span class="va">self</span>):</span>
<span id="cb23-483"><a href="#cb23-483" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze product performance."""</span></span>
<span id="cb23-484"><a href="#cb23-484" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-485"><a href="#cb23-485" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-486"><a href="#cb23-486" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-487"><a href="#cb23-487" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb23-488"><a href="#cb23-488" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-489"><a href="#cb23-489" aria-hidden="true" tabindex="-1"></a>        product_stats <span class="op">=</span> df.groupby(<span class="st">'Product'</span>).agg({</span>
<span id="cb23-490"><a href="#cb23-490" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'count'</span>],</span>
<span id="cb23-491"><a href="#cb23-491" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb23-492"><a href="#cb23-492" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span>,</span>
<span id="cb23-493"><a href="#cb23-493" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Unit_Price'</span>: <span class="st">'mean'</span></span>
<span id="cb23-494"><a href="#cb23-494" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb23-495"><a href="#cb23-495" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-496"><a href="#cb23-496" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Flatten column names</span></span>
<span id="cb23-497"><a href="#cb23-497" aria-hidden="true" tabindex="-1"></a>        product_stats.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> product_stats.columns]</span>
<span id="cb23-498"><a href="#cb23-498" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-499"><a href="#cb23-499" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate profit margin by product</span></span>
<span id="cb23-500"><a href="#cb23-500" aria-hidden="true" tabindex="-1"></a>        product_stats[<span class="st">'Profit_Margin'</span>] <span class="op">=</span> (</span>
<span id="cb23-501"><a href="#cb23-501" aria-hidden="true" tabindex="-1"></a>            product_stats[<span class="st">'Profit_sum'</span>] <span class="op">/</span> product_stats[<span class="st">'Revenue_sum'</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb23-502"><a href="#cb23-502" aria-hidden="true" tabindex="-1"></a>        ).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb23-503"><a href="#cb23-503" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-504"><a href="#cb23-504" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> product_stats</span>
<span id="cb23-505"><a href="#cb23-505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-506"><a href="#cb23-506" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> regional_analysis(<span class="va">self</span>):</span>
<span id="cb23-507"><a href="#cb23-507" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze regional performance."""</span></span>
<span id="cb23-508"><a href="#cb23-508" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-509"><a href="#cb23-509" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-510"><a href="#cb23-510" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-511"><a href="#cb23-511" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb23-512"><a href="#cb23-512" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-513"><a href="#cb23-513" aria-hidden="true" tabindex="-1"></a>        regional_stats <span class="op">=</span> df.groupby(<span class="st">'Region'</span>).agg({</span>
<span id="cb23-514"><a href="#cb23-514" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb23-515"><a href="#cb23-515" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>],</span>
<span id="cb23-516"><a href="#cb23-516" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity'</span>: <span class="st">'sum'</span></span>
<span id="cb23-517"><a href="#cb23-517" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb23-518"><a href="#cb23-518" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-519"><a href="#cb23-519" aria-hidden="true" tabindex="-1"></a>        regional_stats.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> regional_stats.columns]</span>
<span id="cb23-520"><a href="#cb23-520" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-521"><a href="#cb23-521" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Market share by region</span></span>
<span id="cb23-522"><a href="#cb23-522" aria-hidden="true" tabindex="-1"></a>        total_revenue <span class="op">=</span> df[<span class="st">'Revenue'</span>].<span class="bu">sum</span>()</span>
<span id="cb23-523"><a href="#cb23-523" aria-hidden="true" tabindex="-1"></a>        regional_stats[<span class="st">'Market_Share'</span>] <span class="op">=</span> (</span>
<span id="cb23-524"><a href="#cb23-524" aria-hidden="true" tabindex="-1"></a>            regional_stats[<span class="st">'Revenue_sum'</span>] <span class="op">/</span> total_revenue <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb23-525"><a href="#cb23-525" aria-hidden="true" tabindex="-1"></a>        ).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb23-526"><a href="#cb23-526" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-527"><a href="#cb23-527" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> regional_stats</span>
<span id="cb23-528"><a href="#cb23-528" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-529"><a href="#cb23-529" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sales_rep_analysis(<span class="va">self</span>):</span>
<span id="cb23-530"><a href="#cb23-530" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Analyze sales representative performance."""</span></span>
<span id="cb23-531"><a href="#cb23-531" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-532"><a href="#cb23-532" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-533"><a href="#cb23-533" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-534"><a href="#cb23-534" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> <span class="va">self</span>.data</span>
<span id="cb23-535"><a href="#cb23-535" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-536"><a href="#cb23-536" aria-hidden="true" tabindex="-1"></a>        rep_stats <span class="op">=</span> df.groupby(<span class="st">'Sales_Rep'</span>).agg({</span>
<span id="cb23-537"><a href="#cb23-537" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Revenue'</span>: [<span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'count'</span>],</span>
<span id="cb23-538"><a href="#cb23-538" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Profit'</span>: <span class="st">'sum'</span></span>
<span id="cb23-539"><a href="#cb23-539" aria-hidden="true" tabindex="-1"></a>        }).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb23-540"><a href="#cb23-540" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-541"><a href="#cb23-541" aria-hidden="true" tabindex="-1"></a>        rep_stats.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col).strip() <span class="cf">for</span> col <span class="kw">in</span> rep_stats.columns]</span>
<span id="cb23-542"><a href="#cb23-542" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-543"><a href="#cb23-543" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Rank representatives</span></span>
<span id="cb23-544"><a href="#cb23-544" aria-hidden="true" tabindex="-1"></a>        rep_stats[<span class="st">'Revenue_Rank'</span>] <span class="op">=</span> rep_stats[<span class="st">'Revenue_sum'</span>].rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-545"><a href="#cb23-545" aria-hidden="true" tabindex="-1"></a>        rep_stats[<span class="st">'Avg_Deal_Size'</span>] <span class="op">=</span> rep_stats[<span class="st">'Revenue_mean'</span>]</span>
<span id="cb23-546"><a href="#cb23-546" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-547"><a href="#cb23-547" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rep_stats.sort_values(<span class="st">'Revenue_sum'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-548"><a href="#cb23-548" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-549"><a href="#cb23-549" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_visualizations(<span class="va">self</span>):</span>
<span id="cb23-550"><a href="#cb23-550" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Create comprehensive visualizations."""</span></span>
<span id="cb23-551"><a href="#cb23-551" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-552"><a href="#cb23-552" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-553"><a href="#cb23-553" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-554"><a href="#cb23-554" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb23-555"><a href="#cb23-555" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(<span class="st">'Sales Data Analysis Dashboard'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb23-556"><a href="#cb23-556" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-557"><a href="#cb23-557" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Monthly Revenue Trend</span></span>
<span id="cb23-558"><a href="#cb23-558" aria-hidden="true" tabindex="-1"></a>        time_data <span class="op">=</span> <span class="va">self</span>.time_series_analysis()</span>
<span id="cb23-559"><a href="#cb23-559" aria-hidden="true" tabindex="-1"></a>        monthly_data <span class="op">=</span> time_data[<span class="st">'monthly'</span>]</span>
<span id="cb23-560"><a href="#cb23-560" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-561"><a href="#cb23-561" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(monthly_data[<span class="st">'Date'</span>], monthly_data[<span class="st">'Revenue'</span>], </span>
<span id="cb23-562"><a href="#cb23-562" aria-hidden="true" tabindex="-1"></a>                       marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb23-563"><a href="#cb23-563" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Monthly Revenue Trend'</span>)</span>
<span id="cb23-564"><a href="#cb23-564" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Month'</span>)</span>
<span id="cb23-565"><a href="#cb23-565" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Revenue ($)'</span>)</span>
<span id="cb23-566"><a href="#cb23-566" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-567"><a href="#cb23-567" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-568"><a href="#cb23-568" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Product Performance</span></span>
<span id="cb23-569"><a href="#cb23-569" aria-hidden="true" tabindex="-1"></a>        product_data <span class="op">=</span> <span class="va">self</span>.product_analysis()</span>
<span id="cb23-570"><a href="#cb23-570" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].bar(product_data.index, product_data[<span class="st">'Revenue_sum'</span>], </span>
<span id="cb23-571"><a href="#cb23-571" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'lightgreen'</span>, edgecolor<span class="op">=</span><span class="st">'darkgreen'</span>)</span>
<span id="cb23-572"><a href="#cb23-572" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Revenue by Product'</span>)</span>
<span id="cb23-573"><a href="#cb23-573" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Product'</span>)</span>
<span id="cb23-574"><a href="#cb23-574" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Total Revenue ($)'</span>)</span>
<span id="cb23-575"><a href="#cb23-575" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-576"><a href="#cb23-576" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-577"><a href="#cb23-577" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Regional Market Share</span></span>
<span id="cb23-578"><a href="#cb23-578" aria-hidden="true" tabindex="-1"></a>        regional_data <span class="op">=</span> <span class="va">self</span>.regional_analysis()</span>
<span id="cb23-579"><a href="#cb23-579" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].pie(regional_data[<span class="st">'Revenue_sum'</span>], labels<span class="op">=</span>regional_data.index, </span>
<span id="cb23-580"><a href="#cb23-580" aria-hidden="true" tabindex="-1"></a>                      autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>, startangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb23-581"><a href="#cb23-581" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Market Share by Region'</span>)</span>
<span id="cb23-582"><a href="#cb23-582" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-583"><a href="#cb23-583" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Quarterly Profit Trend</span></span>
<span id="cb23-584"><a href="#cb23-584" aria-hidden="true" tabindex="-1"></a>        quarterly_data <span class="op">=</span> time_data[<span class="st">'quarterly'</span>]</span>
<span id="cb23-585"><a href="#cb23-585" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].bar(quarterly_data.index, quarterly_data[<span class="st">'Profit'</span>], </span>
<span id="cb23-586"><a href="#cb23-586" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span><span class="st">'orange'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb23-587"><a href="#cb23-587" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Quarterly Profit'</span>)</span>
<span id="cb23-588"><a href="#cb23-588" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Quarter'</span>)</span>
<span id="cb23-589"><a href="#cb23-589" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Profit ($)'</span>)</span>
<span id="cb23-590"><a href="#cb23-590" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-591"><a href="#cb23-591" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5. Day of Week Analysis</span></span>
<span id="cb23-592"><a href="#cb23-592" aria-hidden="true" tabindex="-1"></a>        dow_data <span class="op">=</span> time_data[<span class="st">'day_of_week'</span>]</span>
<span id="cb23-593"><a href="#cb23-593" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(<span class="bu">range</span>(<span class="bu">len</span>(dow_data)), dow_data[<span class="st">'Revenue'</span>], </span>
<span id="cb23-594"><a href="#cb23-594" aria-hidden="true" tabindex="-1"></a>                       marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb23-595"><a href="#cb23-595" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Average Daily Revenue by Day of Week'</span>)</span>
<span id="cb23-596"><a href="#cb23-596" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Day of Week'</span>)</span>
<span id="cb23-597"><a href="#cb23-597" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Average Revenue ($)'</span>)</span>
<span id="cb23-598"><a href="#cb23-598" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(dow_data)))</span>
<span id="cb23-599"><a href="#cb23-599" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticklabels(dow_data.index, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-600"><a href="#cb23-600" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-601"><a href="#cb23-601" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 6. Revenue vs Profit Scatter</span></span>
<span id="cb23-602"><a href="#cb23-602" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].scatter(<span class="va">self</span>.data[<span class="st">'Revenue'</span>], <span class="va">self</span>.data[<span class="st">'Profit'</span>], </span>
<span id="cb23-603"><a href="#cb23-603" aria-hidden="true" tabindex="-1"></a>                          alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb23-604"><a href="#cb23-604" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_title(<span class="st">'Revenue vs Profit Correlation'</span>)</span>
<span id="cb23-605"><a href="#cb23-605" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_xlabel(<span class="st">'Revenue ($)'</span>)</span>
<span id="cb23-606"><a href="#cb23-606" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_ylabel(<span class="st">'Profit ($)'</span>)</span>
<span id="cb23-607"><a href="#cb23-607" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-608"><a href="#cb23-608" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add trend line</span></span>
<span id="cb23-609"><a href="#cb23-609" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> np.polyfit(<span class="va">self</span>.data[<span class="st">'Revenue'</span>], <span class="va">self</span>.data[<span class="st">'Profit'</span>], <span class="dv">1</span>)</span>
<span id="cb23-610"><a href="#cb23-610" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb23-611"><a href="#cb23-611" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].plot(<span class="va">self</span>.data[<span class="st">'Revenue'</span>], p(<span class="va">self</span>.data[<span class="st">'Revenue'</span>]), <span class="st">"r--"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb23-612"><a href="#cb23-612" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-613"><a href="#cb23-613" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb23-614"><a href="#cb23-614" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb23-615"><a href="#cb23-615" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-616"><a href="#cb23-616" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_report(<span class="va">self</span>):</span>
<span id="cb23-617"><a href="#cb23-617" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate comprehensive analysis report."""</span></span>
<span id="cb23-618"><a href="#cb23-618" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-619"><a href="#cb23-619" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"No data available. Generate data first."</span>)</span>
<span id="cb23-620"><a href="#cb23-620" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb23-621"><a href="#cb23-621" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-622"><a href="#cb23-622" aria-hidden="true" tabindex="-1"></a>        basic_stats <span class="op">=</span> <span class="va">self</span>.basic_analysis()</span>
<span id="cb23-623"><a href="#cb23-623" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-624"><a href="#cb23-624" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb23-625"><a href="#cb23-625" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"SALES DATA ANALYSIS REPORT"</span>)</span>
<span id="cb23-626"><a href="#cb23-626" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb23-627"><a href="#cb23-627" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-628"><a href="#cb23-628" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">📊 OVERVIEW"</span>)</span>
<span id="cb23-629"><a href="#cb23-629" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Total Records: </span><span class="sc">{</span>basic_stats[<span class="st">'total_records'</span>]<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb23-630"><a href="#cb23-630" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Date Range: </span><span class="sc">{</span>basic_stats[<span class="st">'date_range'</span>][<span class="dv">0</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>basic_stats[<span class="st">'date_range'</span>][<span class="dv">1</span>]<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-631"><a href="#cb23-631" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Total Revenue: $</span><span class="sc">{</span>basic_stats[<span class="st">'total_revenue'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb23-632"><a href="#cb23-632" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Total Profit: $</span><span class="sc">{</span>basic_stats[<span class="st">'total_profit'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb23-633"><a href="#cb23-633" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Profit Margin: </span><span class="sc">{</span>basic_stats[<span class="st">'profit_margin'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-634"><a href="#cb23-634" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Average Order Value: $</span><span class="sc">{</span>basic_stats[<span class="st">'avg_order_value'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb23-635"><a href="#cb23-635" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-636"><a href="#cb23-636" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">🏆 TOP PERFORMERS"</span>)</span>
<span id="cb23-637"><a href="#cb23-637" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Best Product: </span><span class="sc">{</span>basic_stats[<span class="st">'top_product'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-638"><a href="#cb23-638" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Best Region: </span><span class="sc">{</span>basic_stats[<span class="st">'top_region'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-639"><a href="#cb23-639" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   Best Sales Rep: </span><span class="sc">{</span>basic_stats[<span class="st">'top_sales_rep'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-640"><a href="#cb23-640" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-641"><a href="#cb23-641" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Product analysis</span></span>
<span id="cb23-642"><a href="#cb23-642" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">📦 PRODUCT ANALYSIS"</span>)</span>
<span id="cb23-643"><a href="#cb23-643" aria-hidden="true" tabindex="-1"></a>        product_stats <span class="op">=</span> <span class="va">self</span>.product_analysis()</span>
<span id="cb23-644"><a href="#cb23-644" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(product_stats.sort_values(<span class="st">'Revenue_sum'</span>, ascending<span class="op">=</span><span class="va">False</span>).head())</span>
<span id="cb23-645"><a href="#cb23-645" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-646"><a href="#cb23-646" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Regional analysis</span></span>
<span id="cb23-647"><a href="#cb23-647" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">🌍 REGIONAL ANALYSIS"</span>)</span>
<span id="cb23-648"><a href="#cb23-648" aria-hidden="true" tabindex="-1"></a>        regional_stats <span class="op">=</span> <span class="va">self</span>.regional_analysis()</span>
<span id="cb23-649"><a href="#cb23-649" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(regional_stats.sort_values(<span class="st">'Revenue_sum'</span>, ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb23-650"><a href="#cb23-650" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-651"><a href="#cb23-651" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sales rep performance</span></span>
<span id="cb23-652"><a href="#cb23-652" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">👥 TOP SALES REPRESENTATIVES"</span>)</span>
<span id="cb23-653"><a href="#cb23-653" aria-hidden="true" tabindex="-1"></a>        rep_stats <span class="op">=</span> <span class="va">self</span>.sales_rep_analysis()</span>
<span id="cb23-654"><a href="#cb23-654" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(rep_stats.head(<span class="dv">10</span>))</span>
<span id="cb23-655"><a href="#cb23-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-656"><a href="#cb23-656" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate the sales analyzer</span></span>
<span id="cb23-657"><a href="#cb23-657" aria-hidden="true" tabindex="-1"></a>analyzer <span class="op">=</span> SalesAnalyzer()</span>
<span id="cb23-658"><a href="#cb23-658" aria-hidden="true" tabindex="-1"></a>analyzer.generate_sample_data(<span class="dv">1500</span>)</span>
<span id="cb23-659"><a href="#cb23-659" aria-hidden="true" tabindex="-1"></a>analyzer.generate_report()</span>
<span id="cb23-660"><a href="#cb23-660" aria-hidden="true" tabindex="-1"></a>analyzer.create_visualizations()</span>
<span id="cb23-661"><a href="#cb23-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-662"><a href="#cb23-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-663"><a href="#cb23-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## Machine Learning Basics</span></span>
<span id="cb23-664"><a href="#cb23-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-665"><a href="#cb23-665" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scikit-learn Introduction</span></span>
<span id="cb23-666"><a href="#cb23-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-669"><a href="#cb23-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-670"><a href="#cb23-670" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb23-671"><a href="#cb23-671" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, LogisticRegression</span>
<span id="cb23-672"><a href="#cb23-672" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb23-673"><a href="#cb23-673" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, accuracy_score, classification_report</span>
<span id="cb23-674"><a href="#cb23-674" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb23-675"><a href="#cb23-675" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-676"><a href="#cb23-676" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-677"><a href="#cb23-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-678"><a href="#cb23-678" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== Machine Learning with Scikit-learn ==="</span>)</span>
<span id="cb23-679"><a href="#cb23-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-680"><a href="#cb23-680" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regression_example():</span>
<span id="cb23-681"><a href="#cb23-681" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Demonstrate linear regression."""</span></span>
<span id="cb23-682"><a href="#cb23-682" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. Linear Regression Example"</span>)</span>
<span id="cb23-683"><a href="#cb23-683" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-684"><a href="#cb23-684" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate sample data</span></span>
<span id="cb23-685"><a href="#cb23-685" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">42</span>)</span>
<span id="cb23-686"><a href="#cb23-686" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb23-687"><a href="#cb23-687" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.random.randn(n_samples, <span class="dv">3</span>)  <span class="co"># 3 features</span></span>
<span id="cb23-688"><a href="#cb23-688" aria-hidden="true" tabindex="-1"></a>    true_coefficients <span class="op">=</span> [<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="fl">0.5</span>]</span>
<span id="cb23-689"><a href="#cb23-689" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> X.dot(true_coefficients) <span class="op">+</span> np.random.randn(n_samples) <span class="op">*</span> <span class="fl">0.1</span></span>
<span id="cb23-690"><a href="#cb23-690" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-691"><a href="#cb23-691" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create feature names</span></span>
<span id="cb23-692"><a href="#cb23-692" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [<span class="st">'Feature_1'</span>, <span class="st">'Feature_2'</span>, <span class="st">'Feature_3'</span>]</span>
<span id="cb23-693"><a href="#cb23-693" aria-hidden="true" tabindex="-1"></a>    X_df <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>feature_names)</span>
<span id="cb23-694"><a href="#cb23-694" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-695"><a href="#cb23-695" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split data</span></span>
<span id="cb23-696"><a href="#cb23-696" aria-hidden="true" tabindex="-1"></a>    X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb23-697"><a href="#cb23-697" aria-hidden="true" tabindex="-1"></a>        X_df, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb23-698"><a href="#cb23-698" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-699"><a href="#cb23-699" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-700"><a href="#cb23-700" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train model</span></span>
<span id="cb23-701"><a href="#cb23-701" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> LinearRegression()</span>
<span id="cb23-702"><a href="#cb23-702" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb23-703"><a href="#cb23-703" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-704"><a href="#cb23-704" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions</span></span>
<span id="cb23-705"><a href="#cb23-705" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb23-706"><a href="#cb23-706" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-707"><a href="#cb23-707" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate</span></span>
<span id="cb23-708"><a href="#cb23-708" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb23-709"><a href="#cb23-709" aria-hidden="true" tabindex="-1"></a>    r2_score <span class="op">=</span> model.score(X_test, y_test)</span>
<span id="cb23-710"><a href="#cb23-710" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-711"><a href="#cb23-711" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Model Coefficients: </span><span class="sc">{</span>model<span class="sc">.</span>coef_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-712"><a href="#cb23-712" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   True Coefficients: </span><span class="sc">{</span>true_coefficients<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-713"><a href="#cb23-713" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Mean Squared Error: </span><span class="sc">{</span>mse<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb23-714"><a href="#cb23-714" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   R² Score: </span><span class="sc">{</span>r2_score<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb23-715"><a href="#cb23-715" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-716"><a href="#cb23-716" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model, X_test, y_test, y_pred</span>
<span id="cb23-717"><a href="#cb23-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-718"><a href="#cb23-718" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classification_example():</span>
<span id="cb23-719"><a href="#cb23-719" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Demonstrate classification."""</span></span>
<span id="cb23-720"><a href="#cb23-720" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. Classification Example"</span>)</span>
<span id="cb23-721"><a href="#cb23-721" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-722"><a href="#cb23-722" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate sample data</span></span>
<span id="cb23-723"><a href="#cb23-723" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb23-724"><a href="#cb23-724" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-725"><a href="#cb23-725" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> make_classification(</span>
<span id="cb23-726"><a href="#cb23-726" aria-hidden="true" tabindex="-1"></a>        n_samples<span class="op">=</span><span class="dv">1000</span>, n_features<span class="op">=</span><span class="dv">10</span>, n_informative<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb23-727"><a href="#cb23-727" aria-hidden="true" tabindex="-1"></a>        n_redundant<span class="op">=</span><span class="dv">2</span>, n_classes<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb23-728"><a href="#cb23-728" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-729"><a href="#cb23-729" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-730"><a href="#cb23-730" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> [<span class="ss">f'Feature_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>])]</span>
<span id="cb23-731"><a href="#cb23-731" aria-hidden="true" tabindex="-1"></a>    X_df <span class="op">=</span> pd.DataFrame(X, columns<span class="op">=</span>feature_names)</span>
<span id="cb23-732"><a href="#cb23-732" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-733"><a href="#cb23-733" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split data</span></span>
<span id="cb23-734"><a href="#cb23-734" aria-hidden="true" tabindex="-1"></a>    X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb23-735"><a href="#cb23-735" aria-hidden="true" tabindex="-1"></a>        X_df, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y</span>
<span id="cb23-736"><a href="#cb23-736" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-737"><a href="#cb23-737" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-738"><a href="#cb23-738" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scale features</span></span>
<span id="cb23-739"><a href="#cb23-739" aria-hidden="true" tabindex="-1"></a>    scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb23-740"><a href="#cb23-740" aria-hidden="true" tabindex="-1"></a>    X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb23-741"><a href="#cb23-741" aria-hidden="true" tabindex="-1"></a>    X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb23-742"><a href="#cb23-742" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-743"><a href="#cb23-743" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train models</span></span>
<span id="cb23-744"><a href="#cb23-744" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> {</span>
<span id="cb23-745"><a href="#cb23-745" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Logistic Regression'</span>: LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb23-746"><a href="#cb23-746" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Random Forest'</span>: RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb23-747"><a href="#cb23-747" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-748"><a href="#cb23-748" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-749"><a href="#cb23-749" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> {}</span>
<span id="cb23-750"><a href="#cb23-750" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, model <span class="kw">in</span> models.items():</span>
<span id="cb23-751"><a href="#cb23-751" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train</span></span>
<span id="cb23-752"><a href="#cb23-752" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train_scaled, y_train)</span>
<span id="cb23-753"><a href="#cb23-753" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-754"><a href="#cb23-754" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict</span></span>
<span id="cb23-755"><a href="#cb23-755" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> model.predict(X_test_scaled)</span>
<span id="cb23-756"><a href="#cb23-756" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-757"><a href="#cb23-757" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Evaluate</span></span>
<span id="cb23-758"><a href="#cb23-758" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb23-759"><a href="#cb23-759" aria-hidden="true" tabindex="-1"></a>        results[name] <span class="op">=</span> {</span>
<span id="cb23-760"><a href="#cb23-760" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: model,</span>
<span id="cb23-761"><a href="#cb23-761" aria-hidden="true" tabindex="-1"></a>            <span class="st">'accuracy'</span>: accuracy,</span>
<span id="cb23-762"><a href="#cb23-762" aria-hidden="true" tabindex="-1"></a>            <span class="st">'predictions'</span>: y_pred</span>
<span id="cb23-763"><a href="#cb23-763" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-764"><a href="#cb23-764" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-765"><a href="#cb23-765" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb23-766"><a href="#cb23-766" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     Accuracy: </span><span class="sc">{</span>accuracy<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb23-767"><a href="#cb23-767" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-768"><a href="#cb23-768" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results, X_test_scaled, y_test</span>
<span id="cb23-769"><a href="#cb23-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-770"><a href="#cb23-770" aria-hidden="true" tabindex="-1"></a><span class="co"># Run examples</span></span>
<span id="cb23-771"><a href="#cb23-771" aria-hidden="true" tabindex="-1"></a>regression_model, X_reg_test, y_reg_test, y_reg_pred <span class="op">=</span> regression_example()</span>
<span id="cb23-772"><a href="#cb23-772" aria-hidden="true" tabindex="-1"></a>classification_results, X_clf_test, y_clf_test <span class="op">=</span> classification_example()</span>
<span id="cb23-773"><a href="#cb23-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-774"><a href="#cb23-774" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance for Random Forest</span></span>
<span id="cb23-775"><a href="#cb23-775" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> classification_results[<span class="st">'Random Forest'</span>][<span class="st">'model'</span>]</span>
<span id="cb23-776"><a href="#cb23-776" aria-hidden="true" tabindex="-1"></a>feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb23-777"><a href="#cb23-777" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: [<span class="ss">f'Feature_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(rf_model.feature_importances_))],</span>
<span id="cb23-778"><a href="#cb23-778" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Importance'</span>: rf_model.feature_importances_</span>
<span id="cb23-779"><a href="#cb23-779" aria-hidden="true" tabindex="-1"></a>}).sort_values(<span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-780"><a href="#cb23-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-781"><a href="#cb23-781" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Random Forest Feature Importance:"</span>)</span>
<span id="cb23-782"><a href="#cb23-782" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance.head())</span>
<span id="cb23-783"><a href="#cb23-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-784"><a href="#cb23-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-785"><a href="#cb23-785" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Science Workflow</span></span>
<span id="cb23-786"><a href="#cb23-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-787"><a href="#cb23-787" aria-hidden="true" tabindex="-1"></a><span class="fu">### End-to-End Data Science Project</span></span>
<span id="cb23-788"><a href="#cb23-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-791"><a href="#cb23-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-792"><a href="#cb23-792" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-793"><a href="#cb23-793" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-794"><a href="#cb23-794" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb23-795"><a href="#cb23-795" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, cross_val_score</span>
<span id="cb23-796"><a href="#cb23-796" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelEncoder</span>
<span id="cb23-797"><a href="#cb23-797" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb23-798"><a href="#cb23-798" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb23-799"><a href="#cb23-799" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb23-800"><a href="#cb23-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-801"><a href="#cb23-801" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataScienceProject:</span>
<span id="cb23-802"><a href="#cb23-802" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""End-to-end data science project workflow."""</span></span>
<span id="cb23-803"><a href="#cb23-803" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-804"><a href="#cb23-804" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, project_name: <span class="bu">str</span>):</span>
<span id="cb23-805"><a href="#cb23-805" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.project_name <span class="op">=</span> project_name</span>
<span id="cb23-806"><a href="#cb23-806" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-807"><a href="#cb23-807" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processed_data <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-808"><a href="#cb23-808" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-809"><a href="#cb23-809" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.scaler <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-810"><a href="#cb23-810" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label_encoder <span class="op">=</span> <span class="va">None</span></span>
<span id="cb23-811"><a href="#cb23-811" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-812"><a href="#cb23-812" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_and_explore_data(<span class="va">self</span>):</span>
<span id="cb23-813"><a href="#cb23-813" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 1: Load and explore the dataset."""</span></span>
<span id="cb23-814"><a href="#cb23-814" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"=== </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss">: Data Exploration ==="</span>)</span>
<span id="cb23-815"><a href="#cb23-815" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-816"><a href="#cb23-816" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate a realistic customer dataset</span></span>
<span id="cb23-817"><a href="#cb23-817" aria-hidden="true" tabindex="-1"></a>        np.random.seed(<span class="dv">42</span>)</span>
<span id="cb23-818"><a href="#cb23-818" aria-hidden="true" tabindex="-1"></a>        n_customers <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb23-819"><a href="#cb23-819" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-820"><a href="#cb23-820" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Customer demographics</span></span>
<span id="cb23-821"><a href="#cb23-821" aria-hidden="true" tabindex="-1"></a>        ages <span class="op">=</span> np.random.normal(<span class="dv">40</span>, <span class="dv">12</span>, n_customers).astype(<span class="bu">int</span>)</span>
<span id="cb23-822"><a href="#cb23-822" aria-hidden="true" tabindex="-1"></a>        ages <span class="op">=</span> np.clip(ages, <span class="dv">18</span>, <span class="dv">80</span>)</span>
<span id="cb23-823"><a href="#cb23-823" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-824"><a href="#cb23-824" aria-hidden="true" tabindex="-1"></a>        incomes <span class="op">=</span> np.random.lognormal(<span class="fl">10.5</span>, <span class="fl">0.5</span>, n_customers)</span>
<span id="cb23-825"><a href="#cb23-825" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-826"><a href="#cb23-826" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Education levels</span></span>
<span id="cb23-827"><a href="#cb23-827" aria-hidden="true" tabindex="-1"></a>        education_levels <span class="op">=</span> np.random.choice(</span>
<span id="cb23-828"><a href="#cb23-828" aria-hidden="true" tabindex="-1"></a>            [<span class="st">'High School'</span>, <span class="st">'Bachelor'</span>, <span class="st">'Master'</span>, <span class="st">'PhD'</span>],</span>
<span id="cb23-829"><a href="#cb23-829" aria-hidden="true" tabindex="-1"></a>            n_customers, p<span class="op">=</span>[<span class="fl">0.4</span>, <span class="fl">0.35</span>, <span class="fl">0.2</span>, <span class="fl">0.05</span>]</span>
<span id="cb23-830"><a href="#cb23-830" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-831"><a href="#cb23-831" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-832"><a href="#cb23-832" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Spending behavior (influenced by income and age)</span></span>
<span id="cb23-833"><a href="#cb23-833" aria-hidden="true" tabindex="-1"></a>        base_spending <span class="op">=</span> incomes <span class="op">*</span> <span class="fl">0.1</span> <span class="op">+</span> ages <span class="op">*</span> <span class="dv">50</span></span>
<span id="cb23-834"><a href="#cb23-834" aria-hidden="true" tabindex="-1"></a>        spending <span class="op">=</span> base_spending <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="dv">500</span>, n_customers)</span>
<span id="cb23-835"><a href="#cb23-835" aria-hidden="true" tabindex="-1"></a>        spending <span class="op">=</span> np.clip(spending, <span class="dv">0</span>, <span class="va">None</span>)</span>
<span id="cb23-836"><a href="#cb23-836" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-837"><a href="#cb23-837" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Customer segment (target variable)</span></span>
<span id="cb23-838"><a href="#cb23-838" aria-hidden="true" tabindex="-1"></a>        segments <span class="op">=</span> []</span>
<span id="cb23-839"><a href="#cb23-839" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_customers):</span>
<span id="cb23-840"><a href="#cb23-840" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spending[i] <span class="op">&gt;</span> <span class="dv">8000</span>:</span>
<span id="cb23-841"><a href="#cb23-841" aria-hidden="true" tabindex="-1"></a>                segment <span class="op">=</span> <span class="st">'Premium'</span></span>
<span id="cb23-842"><a href="#cb23-842" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> spending[i] <span class="op">&gt;</span> <span class="dv">4000</span>:</span>
<span id="cb23-843"><a href="#cb23-843" aria-hidden="true" tabindex="-1"></a>                segment <span class="op">=</span> <span class="st">'Standard'</span></span>
<span id="cb23-844"><a href="#cb23-844" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb23-845"><a href="#cb23-845" aria-hidden="true" tabindex="-1"></a>                segment <span class="op">=</span> <span class="st">'Basic'</span></span>
<span id="cb23-846"><a href="#cb23-846" aria-hidden="true" tabindex="-1"></a>            segments.append(segment)</span>
<span id="cb23-847"><a href="#cb23-847" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-848"><a href="#cb23-848" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create DataFrame</span></span>
<span id="cb23-849"><a href="#cb23-849" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb23-850"><a href="#cb23-850" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Age'</span>: ages,</span>
<span id="cb23-851"><a href="#cb23-851" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Income'</span>: incomes,</span>
<span id="cb23-852"><a href="#cb23-852" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Education'</span>: education_levels,</span>
<span id="cb23-853"><a href="#cb23-853" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Annual_Spending'</span>: spending,</span>
<span id="cb23-854"><a href="#cb23-854" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Segment'</span>: segments</span>
<span id="cb23-855"><a href="#cb23-855" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb23-856"><a href="#cb23-856" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-857"><a href="#cb23-857" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Dataset shape: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-858"><a href="#cb23-858" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">First 5 rows:"</span>)</span>
<span id="cb23-859"><a href="#cb23-859" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.head())</span>
<span id="cb23-860"><a href="#cb23-860" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-861"><a href="#cb23-861" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Dataset info:"</span>)</span>
<span id="cb23-862"><a href="#cb23-862" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.info())</span>
<span id="cb23-863"><a href="#cb23-863" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-864"><a href="#cb23-864" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Basic statistics:"</span>)</span>
<span id="cb23-865"><a href="#cb23-865" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.describe())</span>
<span id="cb23-866"><a href="#cb23-866" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-867"><a href="#cb23-867" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Segment distribution:"</span>)</span>
<span id="cb23-868"><a href="#cb23-868" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data[<span class="st">'Segment'</span>].value_counts())</span>
<span id="cb23-869"><a href="#cb23-869" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-870"><a href="#cb23-870" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.data</span>
<span id="cb23-871"><a href="#cb23-871" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-872"><a href="#cb23-872" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> data_preprocessing(<span class="va">self</span>):</span>
<span id="cb23-873"><a href="#cb23-873" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 2: Clean and preprocess the data."""</span></span>
<span id="cb23-874"><a href="#cb23-874" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Data Preprocessing ==="</span>)</span>
<span id="cb23-875"><a href="#cb23-875" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-876"><a href="#cb23-876" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-877"><a href="#cb23-877" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Load data first"</span>)</span>
<span id="cb23-878"><a href="#cb23-878" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-879"><a href="#cb23-879" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check for missing values</span></span>
<span id="cb23-880"><a href="#cb23-880" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Missing values:"</span>)</span>
<span id="cb23-881"><a href="#cb23-881" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.data.isnull().<span class="bu">sum</span>())</span>
<span id="cb23-882"><a href="#cb23-882" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-883"><a href="#cb23-883" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Encode categorical variables</span></span>
<span id="cb23-884"><a href="#cb23-884" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label_encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb23-885"><a href="#cb23-885" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-886"><a href="#cb23-886" aria-hidden="true" tabindex="-1"></a>        processed_data <span class="op">=</span> <span class="va">self</span>.data.copy()</span>
<span id="cb23-887"><a href="#cb23-887" aria-hidden="true" tabindex="-1"></a>        processed_data[<span class="st">'Education_Encoded'</span>] <span class="op">=</span> <span class="va">self</span>.label_encoder.fit_transform(</span>
<span id="cb23-888"><a href="#cb23-888" aria-hidden="true" tabindex="-1"></a>            processed_data[<span class="st">'Education'</span>]</span>
<span id="cb23-889"><a href="#cb23-889" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-890"><a href="#cb23-890" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-891"><a href="#cb23-891" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create additional features</span></span>
<span id="cb23-892"><a href="#cb23-892" aria-hidden="true" tabindex="-1"></a>        processed_data[<span class="st">'Income_to_Age_Ratio'</span>] <span class="op">=</span> processed_data[<span class="st">'Income'</span>] <span class="op">/</span> processed_data[<span class="st">'Age'</span>]</span>
<span id="cb23-893"><a href="#cb23-893" aria-hidden="true" tabindex="-1"></a>        processed_data[<span class="st">'Spending_to_Income_Ratio'</span>] <span class="op">=</span> processed_data[<span class="st">'Annual_Spending'</span>] <span class="op">/</span> processed_data[<span class="st">'Income'</span>]</span>
<span id="cb23-894"><a href="#cb23-894" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-895"><a href="#cb23-895" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Feature selection for modeling</span></span>
<span id="cb23-896"><a href="#cb23-896" aria-hidden="true" tabindex="-1"></a>        feature_columns <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'Income'</span>, <span class="st">'Education_Encoded'</span>, <span class="st">'Annual_Spending'</span>, </span>
<span id="cb23-897"><a href="#cb23-897" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'Income_to_Age_Ratio'</span>, <span class="st">'Spending_to_Income_Ratio'</span>]</span>
<span id="cb23-898"><a href="#cb23-898" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-899"><a href="#cb23-899" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processed_data <span class="op">=</span> {</span>
<span id="cb23-900"><a href="#cb23-900" aria-hidden="true" tabindex="-1"></a>            <span class="st">'features'</span>: processed_data[feature_columns],</span>
<span id="cb23-901"><a href="#cb23-901" aria-hidden="true" tabindex="-1"></a>            <span class="st">'target'</span>: processed_data[<span class="st">'Segment'</span>],</span>
<span id="cb23-902"><a href="#cb23-902" aria-hidden="true" tabindex="-1"></a>            <span class="st">'full_data'</span>: processed_data</span>
<span id="cb23-903"><a href="#cb23-903" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-904"><a href="#cb23-904" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-905"><a href="#cb23-905" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Features selected: </span><span class="sc">{</span>feature_columns<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-906"><a href="#cb23-906" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Target variable: Segment"</span>)</span>
<span id="cb23-907"><a href="#cb23-907" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Processed data shape: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>processed_data[<span class="st">'features'</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-908"><a href="#cb23-908" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-909"><a href="#cb23-909" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.processed_data</span>
<span id="cb23-910"><a href="#cb23-910" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-911"><a href="#cb23-911" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> exploratory_data_analysis(<span class="va">self</span>):</span>
<span id="cb23-912"><a href="#cb23-912" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 3: Perform exploratory data analysis."""</span></span>
<span id="cb23-913"><a href="#cb23-913" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Exploratory Data Analysis ==="</span>)</span>
<span id="cb23-914"><a href="#cb23-914" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-915"><a href="#cb23-915" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.processed_data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-916"><a href="#cb23-916" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.data_preprocessing()</span>
<span id="cb23-917"><a href="#cb23-917" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-918"><a href="#cb23-918" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb23-919"><a href="#cb23-919" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(<span class="ss">f'</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss">: Exploratory Data Analysis'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb23-920"><a href="#cb23-920" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-921"><a href="#cb23-921" aria-hidden="true" tabindex="-1"></a>        full_data <span class="op">=</span> <span class="va">self</span>.processed_data[<span class="st">'full_data'</span>]</span>
<span id="cb23-922"><a href="#cb23-922" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-923"><a href="#cb23-923" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. Age distribution by segment</span></span>
<span id="cb23-924"><a href="#cb23-924" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> segment <span class="kw">in</span> full_data[<span class="st">'Segment'</span>].unique():</span>
<span id="cb23-925"><a href="#cb23-925" aria-hidden="true" tabindex="-1"></a>            segment_data <span class="op">=</span> full_data[full_data[<span class="st">'Segment'</span>] <span class="op">==</span> segment]</span>
<span id="cb23-926"><a href="#cb23-926" aria-hidden="true" tabindex="-1"></a>            axes[<span class="dv">0</span>, <span class="dv">0</span>].hist(segment_data[<span class="st">'Age'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span>segment, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb23-927"><a href="#cb23-927" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Age Distribution by Segment'</span>)</span>
<span id="cb23-928"><a href="#cb23-928" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Age'</span>)</span>
<span id="cb23-929"><a href="#cb23-929" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb23-930"><a href="#cb23-930" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">0</span>].legend()</span>
<span id="cb23-931"><a href="#cb23-931" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-932"><a href="#cb23-932" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. Income vs Spending</span></span>
<span id="cb23-933"><a href="#cb23-933" aria-hidden="true" tabindex="-1"></a>        segments <span class="op">=</span> full_data[<span class="st">'Segment'</span>].unique()</span>
<span id="cb23-934"><a href="#cb23-934" aria-hidden="true" tabindex="-1"></a>        colors <span class="op">=</span> [<span class="st">'red'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>]</span>
<span id="cb23-935"><a href="#cb23-935" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> segment, color <span class="kw">in</span> <span class="bu">zip</span>(segments, colors):</span>
<span id="cb23-936"><a href="#cb23-936" aria-hidden="true" tabindex="-1"></a>            segment_data <span class="op">=</span> full_data[full_data[<span class="st">'Segment'</span>] <span class="op">==</span> segment]</span>
<span id="cb23-937"><a href="#cb23-937" aria-hidden="true" tabindex="-1"></a>            axes[<span class="dv">0</span>, <span class="dv">1</span>].scatter(segment_data[<span class="st">'Income'</span>], segment_data[<span class="st">'Annual_Spending'</span>], </span>
<span id="cb23-938"><a href="#cb23-938" aria-hidden="true" tabindex="-1"></a>                             alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span>segment, color<span class="op">=</span>color)</span>
<span id="cb23-939"><a href="#cb23-939" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Income vs Annual Spending'</span>)</span>
<span id="cb23-940"><a href="#cb23-940" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xlabel(<span class="st">'Income ($)'</span>)</span>
<span id="cb23-941"><a href="#cb23-941" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylabel(<span class="st">'Annual Spending ($)'</span>)</span>
<span id="cb23-942"><a href="#cb23-942" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">1</span>].legend()</span>
<span id="cb23-943"><a href="#cb23-943" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-944"><a href="#cb23-944" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. Education distribution</span></span>
<span id="cb23-945"><a href="#cb23-945" aria-hidden="true" tabindex="-1"></a>        education_counts <span class="op">=</span> full_data[<span class="st">'Education'</span>].value_counts()</span>
<span id="cb23-946"><a href="#cb23-946" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].pie(education_counts.values, labels<span class="op">=</span>education_counts.index, autopct<span class="op">=</span><span class="st">'</span><span class="sc">%1.1f%%</span><span class="st">'</span>)</span>
<span id="cb23-947"><a href="#cb23-947" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Education Distribution'</span>)</span>
<span id="cb23-948"><a href="#cb23-948" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-949"><a href="#cb23-949" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. Segment distribution</span></span>
<span id="cb23-950"><a href="#cb23-950" aria-hidden="true" tabindex="-1"></a>        segment_counts <span class="op">=</span> full_data[<span class="st">'Segment'</span>].value_counts()</span>
<span id="cb23-951"><a href="#cb23-951" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].bar(segment_counts.index, segment_counts.values, </span>
<span id="cb23-952"><a href="#cb23-952" aria-hidden="true" tabindex="-1"></a>                      color<span class="op">=</span>[<span class="st">'lightcoral'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightblue'</span>])</span>
<span id="cb23-953"><a href="#cb23-953" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Customer Segment Distribution'</span>)</span>
<span id="cb23-954"><a href="#cb23-954" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xlabel(<span class="st">'Segment'</span>)</span>
<span id="cb23-955"><a href="#cb23-955" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb23-956"><a href="#cb23-956" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-957"><a href="#cb23-957" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5. Correlation heatmap</span></span>
<span id="cb23-958"><a href="#cb23-958" aria-hidden="true" tabindex="-1"></a>        correlation_data <span class="op">=</span> full_data[[<span class="st">'Age'</span>, <span class="st">'Income'</span>, <span class="st">'Annual_Spending'</span>, <span class="st">'Education_Encoded'</span>]].corr()</span>
<span id="cb23-959"><a href="#cb23-959" aria-hidden="true" tabindex="-1"></a>        im <span class="op">=</span> axes[<span class="dv">1</span>, <span class="dv">1</span>].imshow(correlation_data.values, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb23-960"><a href="#cb23-960" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Feature Correlation Heatmap'</span>)</span>
<span id="cb23-961"><a href="#cb23-961" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)))</span>
<span id="cb23-962"><a href="#cb23-962" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)))</span>
<span id="cb23-963"><a href="#cb23-963" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticklabels(correlation_data.columns, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb23-964"><a href="#cb23-964" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">1</span>].set_yticklabels(correlation_data.columns)</span>
<span id="cb23-965"><a href="#cb23-965" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-966"><a href="#cb23-966" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add correlation values</span></span>
<span id="cb23-967"><a href="#cb23-967" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)):</span>
<span id="cb23-968"><a href="#cb23-968" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_data.columns)):</span>
<span id="cb23-969"><a href="#cb23-969" aria-hidden="true" tabindex="-1"></a>                axes[<span class="dv">1</span>, <span class="dv">1</span>].text(j, i, <span class="ss">f'</span><span class="sc">{</span>correlation_data<span class="sc">.</span>iloc[i, j]<span class="sc">:.2f}</span><span class="ss">'</span>, </span>
<span id="cb23-970"><a href="#cb23-970" aria-hidden="true" tabindex="-1"></a>                               ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb23-971"><a href="#cb23-971" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-972"><a href="#cb23-972" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 6. Spending distribution by segment</span></span>
<span id="cb23-973"><a href="#cb23-973" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> segment <span class="kw">in</span> segments:</span>
<span id="cb23-974"><a href="#cb23-974" aria-hidden="true" tabindex="-1"></a>            segment_data <span class="op">=</span> full_data[full_data[<span class="st">'Segment'</span>] <span class="op">==</span> segment]</span>
<span id="cb23-975"><a href="#cb23-975" aria-hidden="true" tabindex="-1"></a>            axes[<span class="dv">1</span>, <span class="dv">2</span>].hist(segment_data[<span class="st">'Annual_Spending'</span>], alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span>segment, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb23-976"><a href="#cb23-976" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_title(<span class="st">'Spending Distribution by Segment'</span>)</span>
<span id="cb23-977"><a href="#cb23-977" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_xlabel(<span class="st">'Annual Spending ($)'</span>)</span>
<span id="cb23-978"><a href="#cb23-978" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].set_ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb23-979"><a href="#cb23-979" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, <span class="dv">2</span>].legend()</span>
<span id="cb23-980"><a href="#cb23-980" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-981"><a href="#cb23-981" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb23-982"><a href="#cb23-982" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb23-983"><a href="#cb23-983" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-984"><a href="#cb23-984" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_model(<span class="va">self</span>):</span>
<span id="cb23-985"><a href="#cb23-985" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 4: Train machine learning model."""</span></span>
<span id="cb23-986"><a href="#cb23-986" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Model Training ==="</span>)</span>
<span id="cb23-987"><a href="#cb23-987" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-988"><a href="#cb23-988" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.processed_data <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb23-989"><a href="#cb23-989" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.data_preprocessing()</span>
<span id="cb23-990"><a href="#cb23-990" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-991"><a href="#cb23-991" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> <span class="va">self</span>.processed_data[<span class="st">'features'</span>]</span>
<span id="cb23-992"><a href="#cb23-992" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="va">self</span>.processed_data[<span class="st">'target'</span>]</span>
<span id="cb23-993"><a href="#cb23-993" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-994"><a href="#cb23-994" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Split data</span></span>
<span id="cb23-995"><a href="#cb23-995" aria-hidden="true" tabindex="-1"></a>        X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb23-996"><a href="#cb23-996" aria-hidden="true" tabindex="-1"></a>            X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y</span>
<span id="cb23-997"><a href="#cb23-997" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-998"><a href="#cb23-998" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-999"><a href="#cb23-999" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Scale features</span></span>
<span id="cb23-1000"><a href="#cb23-1000" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb23-1001"><a href="#cb23-1001" aria-hidden="true" tabindex="-1"></a>        X_train_scaled <span class="op">=</span> <span class="va">self</span>.scaler.fit_transform(X_train)</span>
<span id="cb23-1002"><a href="#cb23-1002" aria-hidden="true" tabindex="-1"></a>        X_test_scaled <span class="op">=</span> <span class="va">self</span>.scaler.transform(X_test)</span>
<span id="cb23-1003"><a href="#cb23-1003" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1004"><a href="#cb23-1004" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Train Random Forest model</span></span>
<span id="cb23-1005"><a href="#cb23-1005" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model <span class="op">=</span> RandomForestClassifier(</span>
<span id="cb23-1006"><a href="#cb23-1006" aria-hidden="true" tabindex="-1"></a>            n_estimators<span class="op">=</span><span class="dv">100</span>, </span>
<span id="cb23-1007"><a href="#cb23-1007" aria-hidden="true" tabindex="-1"></a>            random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb23-1008"><a href="#cb23-1008" aria-hidden="true" tabindex="-1"></a>            max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb23-1009"><a href="#cb23-1009" aria-hidden="true" tabindex="-1"></a>            min_samples_split<span class="op">=</span><span class="dv">5</span></span>
<span id="cb23-1010"><a href="#cb23-1010" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-1011"><a href="#cb23-1011" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1012"><a href="#cb23-1012" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.fit(X_train_scaled, y_train)</span>
<span id="cb23-1013"><a href="#cb23-1013" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1014"><a href="#cb23-1014" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cross-validation</span></span>
<span id="cb23-1015"><a href="#cb23-1015" aria-hidden="true" tabindex="-1"></a>        cv_scores <span class="op">=</span> cross_val_score(</span>
<span id="cb23-1016"><a href="#cb23-1016" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.model, X_train_scaled, y_train, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span></span>
<span id="cb23-1017"><a href="#cb23-1017" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb23-1018"><a href="#cb23-1018" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1019"><a href="#cb23-1019" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Cross-validation scores: </span><span class="sc">{</span>cv_scores<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-1020"><a href="#cb23-1020" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Mean CV accuracy: </span><span class="sc">{</span>cv_scores<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss"> (+/- </span><span class="sc">{</span>cv_scores<span class="sc">.</span>std() <span class="op">*</span> <span class="dv">2</span><span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb23-1021"><a href="#cb23-1021" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1022"><a href="#cb23-1022" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Test set evaluation</span></span>
<span id="cb23-1023"><a href="#cb23-1023" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> <span class="va">self</span>.model.predict(X_test_scaled)</span>
<span id="cb23-1024"><a href="#cb23-1024" aria-hidden="true" tabindex="-1"></a>        test_accuracy <span class="op">=</span> (y_pred <span class="op">==</span> y_test).mean()</span>
<span id="cb23-1025"><a href="#cb23-1025" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1026"><a href="#cb23-1026" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Test set accuracy: </span><span class="sc">{</span>test_accuracy<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb23-1027"><a href="#cb23-1027" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1028"><a href="#cb23-1028" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Feature importance</span></span>
<span id="cb23-1029"><a href="#cb23-1029" aria-hidden="true" tabindex="-1"></a>        feature_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb23-1030"><a href="#cb23-1030" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Feature'</span>: X.columns,</span>
<span id="cb23-1031"><a href="#cb23-1031" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Importance'</span>: <span class="va">self</span>.model.feature_importances_</span>
<span id="cb23-1032"><a href="#cb23-1032" aria-hidden="true" tabindex="-1"></a>        }).sort_values(<span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb23-1033"><a href="#cb23-1033" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1034"><a href="#cb23-1034" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Feature Importance:"</span>)</span>
<span id="cb23-1035"><a href="#cb23-1035" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(feature_importance)</span>
<span id="cb23-1036"><a href="#cb23-1036" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1037"><a href="#cb23-1037" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Detailed classification report</span></span>
<span id="cb23-1038"><a href="#cb23-1038" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Classification Report:"</span>)</span>
<span id="cb23-1039"><a href="#cb23-1039" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb23-1040"><a href="#cb23-1040" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1041"><a href="#cb23-1041" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb23-1042"><a href="#cb23-1042" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: <span class="va">self</span>.model,</span>
<span id="cb23-1043"><a href="#cb23-1043" aria-hidden="true" tabindex="-1"></a>            <span class="st">'test_accuracy'</span>: test_accuracy,</span>
<span id="cb23-1044"><a href="#cb23-1044" aria-hidden="true" tabindex="-1"></a>            <span class="st">'cv_scores'</span>: cv_scores,</span>
<span id="cb23-1045"><a href="#cb23-1045" aria-hidden="true" tabindex="-1"></a>            <span class="st">'feature_importance'</span>: feature_importance,</span>
<span id="cb23-1046"><a href="#cb23-1046" aria-hidden="true" tabindex="-1"></a>            <span class="st">'predictions'</span>: y_pred,</span>
<span id="cb23-1047"><a href="#cb23-1047" aria-hidden="true" tabindex="-1"></a>            <span class="st">'true_labels'</span>: y_test</span>
<span id="cb23-1048"><a href="#cb23-1048" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-1049"><a href="#cb23-1049" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-1050"><a href="#cb23-1050" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> model_evaluation(<span class="va">self</span>, results):</span>
<span id="cb23-1051"><a href="#cb23-1051" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Step 5: Evaluate model performance."""</span></span>
<span id="cb23-1052"><a href="#cb23-1052" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== Model Evaluation ==="</span>)</span>
<span id="cb23-1053"><a href="#cb23-1053" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1054"><a href="#cb23-1054" aria-hidden="true" tabindex="-1"></a>        y_true <span class="op">=</span> results[<span class="st">'true_labels'</span>]</span>
<span id="cb23-1055"><a href="#cb23-1055" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> results[<span class="st">'predictions'</span>]</span>
<span id="cb23-1056"><a href="#cb23-1056" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1057"><a href="#cb23-1057" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Confusion matrix</span></span>
<span id="cb23-1058"><a href="#cb23-1058" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb23-1059"><a href="#cb23-1059" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1060"><a href="#cb23-1060" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb23-1061"><a href="#cb23-1061" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1062"><a href="#cb23-1062" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot confusion matrix</span></span>
<span id="cb23-1063"><a href="#cb23-1063" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb23-1064"><a href="#cb23-1064" aria-hidden="true" tabindex="-1"></a>        sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'d'</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb23-1065"><a href="#cb23-1065" aria-hidden="true" tabindex="-1"></a>                   xticklabels<span class="op">=</span><span class="va">self</span>.model.classes_,</span>
<span id="cb23-1066"><a href="#cb23-1066" aria-hidden="true" tabindex="-1"></a>                   yticklabels<span class="op">=</span><span class="va">self</span>.model.classes_)</span>
<span id="cb23-1067"><a href="#cb23-1067" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">'Confusion Matrix'</span>)</span>
<span id="cb23-1068"><a href="#cb23-1068" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Predicted'</span>)</span>
<span id="cb23-1069"><a href="#cb23-1069" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Actual'</span>)</span>
<span id="cb23-1070"><a href="#cb23-1070" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1071"><a href="#cb23-1071" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot feature importance</span></span>
<span id="cb23-1072"><a href="#cb23-1072" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb23-1073"><a href="#cb23-1073" aria-hidden="true" tabindex="-1"></a>        feature_imp <span class="op">=</span> results[<span class="st">'feature_importance'</span>].head(<span class="dv">6</span>)</span>
<span id="cb23-1074"><a href="#cb23-1074" aria-hidden="true" tabindex="-1"></a>        plt.barh(feature_imp[<span class="st">'Feature'</span>], feature_imp[<span class="st">'Importance'</span>])</span>
<span id="cb23-1075"><a href="#cb23-1075" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="st">'Top Feature Importance'</span>)</span>
<span id="cb23-1076"><a href="#cb23-1076" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Importance'</span>)</span>
<span id="cb23-1077"><a href="#cb23-1077" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1078"><a href="#cb23-1078" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb23-1079"><a href="#cb23-1079" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb23-1080"><a href="#cb23-1080" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-1081"><a href="#cb23-1081" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_complete_project(<span class="va">self</span>):</span>
<span id="cb23-1082"><a href="#cb23-1082" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Run the complete data science project."""</span></span>
<span id="cb23-1083"><a href="#cb23-1083" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"🚀 Starting </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb23-1084"><a href="#cb23-1084" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1085"><a href="#cb23-1085" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 1: Load and explore data</span></span>
<span id="cb23-1086"><a href="#cb23-1086" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.load_and_explore_data()</span>
<span id="cb23-1087"><a href="#cb23-1087" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1088"><a href="#cb23-1088" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 2: Preprocess data</span></span>
<span id="cb23-1089"><a href="#cb23-1089" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_preprocessing()</span>
<span id="cb23-1090"><a href="#cb23-1090" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1091"><a href="#cb23-1091" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 3: EDA</span></span>
<span id="cb23-1092"><a href="#cb23-1092" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.exploratory_data_analysis()</span>
<span id="cb23-1093"><a href="#cb23-1093" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1094"><a href="#cb23-1094" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 4: Train model</span></span>
<span id="cb23-1095"><a href="#cb23-1095" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> <span class="va">self</span>.train_model()</span>
<span id="cb23-1096"><a href="#cb23-1096" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1097"><a href="#cb23-1097" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 5: Evaluate model</span></span>
<span id="cb23-1098"><a href="#cb23-1098" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_evaluation(results)</span>
<span id="cb23-1099"><a href="#cb23-1099" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-1100"><a href="#cb23-1100" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">✅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>project_name<span class="sc">}</span><span class="ss"> completed successfully!"</span>)</span>
<span id="cb23-1101"><a href="#cb23-1101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results</span>
<span id="cb23-1102"><a href="#cb23-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1103"><a href="#cb23-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the complete data science project</span></span>
<span id="cb23-1104"><a href="#cb23-1104" aria-hidden="true" tabindex="-1"></a>project <span class="op">=</span> DataScienceProject(<span class="st">"Customer Segmentation Analysis"</span>)</span>
<span id="cb23-1105"><a href="#cb23-1105" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> project.run_complete_project()</span>
<span id="cb23-1106"><a href="#cb23-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb23-1107"><a href="#cb23-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1108"><a href="#cb23-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Self-Review Questions</span></span>
<span id="cb23-1109"><a href="#cb23-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1110"><a href="#cb23-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">### Knowledge Check</span></span>
<span id="cb23-1111"><a href="#cb23-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1112"><a href="#cb23-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**What are the core libraries in the Python data science ecosystem?**</span>
<span id="cb23-1113"><a href="#cb23-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**When would you use NumPy vs Pandas?**</span>
<span id="cb23-1114"><a href="#cb23-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**What's the difference between supervised and unsupervised learning?**</span>
<span id="cb23-1115"><a href="#cb23-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**How do you handle missing data in a dataset?**</span>
<span id="cb23-1116"><a href="#cb23-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**What metrics would you use to evaluate a classification model?**</span>
<span id="cb23-1117"><a href="#cb23-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1118"><a href="#cb23-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Exercises</span></span>
<span id="cb23-1119"><a href="#cb23-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1120"><a href="#cb23-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Cleaning Challenge**: Clean a messy dataset with missing values and outliers</span>
<span id="cb23-1121"><a href="#cb23-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visualization Project**: Create an interactive dashboard for sales data</span>
<span id="cb23-1122"><a href="#cb23-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Prediction Model**: Build a model to predict house prices</span>
<span id="cb23-1123"><a href="#cb23-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Time Series Analysis**: Analyze stock price trends and patterns</span>
<span id="cb23-1124"><a href="#cb23-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1125"><a href="#cb23-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Answers</span></span>
<span id="cb23-1126"><a href="#cb23-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1127"><a href="#cb23-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>NumPy (arrays), Pandas (dataframes), Matplotlib/Seaborn (visualization), Scikit-learn (ML)</span>
<span id="cb23-1128"><a href="#cb23-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>NumPy for numerical computations; Pandas for data manipulation and analysis</span>
<span id="cb23-1129"><a href="#cb23-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Supervised has labeled data; unsupervised finds patterns in unlabeled data</span>
<span id="cb23-1130"><a href="#cb23-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Remove, impute with mean/median/mode, or use advanced imputation techniques</span>
<span id="cb23-1131"><a href="#cb23-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Accuracy, precision, recall, F1-score, ROC-AUC for classification</span>
<span id="cb23-1132"><a href="#cb23-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1133"><a href="#cb23-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">## Best Practices</span></span>
<span id="cb23-1134"><a href="#cb23-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1135"><a href="#cb23-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Start with data exploration** - understand your data before modeling</span>
<span id="cb23-1136"><a href="#cb23-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Clean data thoroughly** - garbage in, garbage out</span>
<span id="cb23-1137"><a href="#cb23-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Feature engineering** - create meaningful features from raw data</span>
<span id="cb23-1138"><a href="#cb23-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Cross-validation** - properly evaluate model performance</span>
<span id="cb23-1139"><a href="#cb23-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Document everything** - reproducible analysis is crucial</span>
<span id="cb23-1140"><a href="#cb23-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Version control** - track data, code, and model versions</span>
<span id="cb23-1141"><a href="#cb23-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1142"><a href="#cb23-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">## Next Steps</span></span>
<span id="cb23-1143"><a href="#cb23-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1144"><a href="#cb23-1144" aria-hidden="true" tabindex="-1"></a>Excellent! You now have a solid foundation in data science with Python. Next, we'll explore <span class="co">[</span><span class="ot">Web Development</span><span class="co">](13-web-development.qmd)</span> to learn how to build web applications with Streamlit and FastAPI.</span>
<span id="cb23-1145"><a href="#cb23-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1146"><a href="#cb23-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources</span></span>
<span id="cb23-1147"><a href="#cb23-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-1148"><a href="#cb23-1148" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Pandas Documentation</span><span class="co">](https://pandas.pydata.org/docs/)</span></span>
<span id="cb23-1149"><a href="#cb23-1149" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">NumPy Documentation</span><span class="co">](https://numpy.org/doc/)</span></span>
<span id="cb23-1150"><a href="#cb23-1150" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Matplotlib Documentation</span><span class="co">](https://matplotlib.org/stable/contents.html)</span></span>
<span id="cb23-1151"><a href="#cb23-1151" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Scikit-learn Documentation</span><span class="co">](https://scikit-learn.org/stable/)</span></span>
<span id="cb23-1152"><a href="#cb23-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Kaggle Learn</span><span class="co">](https://www.kaggle.com/learn)</span> - Free micro-courses</span>
<span id="cb23-1153"><a href="#cb23-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Python Data Science Handbook</span><span class="co">](https://jakevdp.github.io/PythonDataScienceHandbook/)</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>